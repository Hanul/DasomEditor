!function(t){global.__PAPA=t()}(function(){"use strict";function t(t,e){e=e||{};var n=e.dynamicTyping||!1;if(m(n)&&(e.dynamicTypingFunction=n,n={}),e.dynamicTyping=n,e.transform=!!m(e.transform)&&e.transform,e.worker&&C.WORKERS_SUPPORTED){var d=l();return d.userStep=e.step,d.userChunk=e.chunk,d.userComplete=e.complete,d.userError=e.error,e.step=m(e.step),e.chunk=m(e.chunk),e.complete=m(e.complete),e.error=m(e.error),delete e.worker,void d.postMessage({input:t,config:e,workerId:d.id})}var c=null;return t===C.NODE_STREAM_INPUT?(c=new a(e),c.getStream()):("string"==typeof t?c=e.download?new o(e):new r(e):t.readable===!0&&m(t.read)&&m(t.on)?c=new s(e):(global.File&&t instanceof File||t instanceof Object)&&(c=new i(e)),c.stream(t))}function e(t,e){function n(){"object"==typeof e&&("string"==typeof e.delimiter&&1===e.delimiter.length&&C.BAD_DELIMITERS.indexOf(e.delimiter)===-1&&(c=e.delimiter),("boolean"==typeof e.quotes||e.quotes instanceof Array)&&(a=e.quotes),"string"==typeof e.newline&&(u=e.newline),"string"==typeof e.quoteChar&&(l=e.quoteChar),"boolean"==typeof e.header&&(d=e.header))}function o(t){if("object"!=typeof t)return[];var e=[];for(var n in t)e.push(n);return e}function i(t,e){var n="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var o=t instanceof Array&&t.length>0,i=!(e[0]instanceof Array);if(o&&d){for(var s=0;s<t.length;s++)s>0&&(n+=c),n+=r(t[s],s);e.length>0&&(n+=u)}for(var a=0;a<e.length;a++){for(var l=o?t.length:e[a].length,f=0;f<l;f++){f>0&&(n+=c);var p=o&&i?t[f]:f;n+=r(e[a][p],f)}a<e.length-1&&(n+=u)}return n}function r(t,e){if("undefined"==typeof t||null===t)return"";if(t.constructor===Date)return JSON.stringify(t).slice(1,25);t=t.toString().replace(f,l+l);var n="boolean"==typeof a&&a||a instanceof Array&&a[e]||s(t,C.BAD_DELIMITERS)||t.indexOf(c)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1);return n?l+t+l:t}function s(t,e){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1}var a=!1,d=!0,c=",",u="\r\n",l='"';n();var f=new RegExp(l,"g");if("string"==typeof t&&(t=JSON.parse(t)),t instanceof Array){if(!t.length||t[0]instanceof Array)return i(null,t);if("object"==typeof t[0])return i(o(t[0]),t)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),t.data instanceof Array&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=t.data[0]instanceof Array?t.fields:o(t.data[0])),t.data[0]instanceof Array||"object"==typeof t.data[0]||(t.data=[t.data])),i(t.fields||[],t.data||[]);throw"exception: Unable to serialize unrecognized input"}function n(t){function e(t){var e=k(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new d(e),this._handle.streamer=this,this._config=e}this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},e.call(this,t),this.parseChunk=function(t,e){if(this.isFirstChunk&&m(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(t);void 0!==n&&(t=n)}this.isFirstChunk=!1;var o=this._partialLine+t;this._partialLine="";var i=this._handle.parse(o,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var r=i.meta.cursor;this._finished||(this._partialLine=o.substring(r-this._baseIndex),this._baseIndex=r),i&&i.data&&(this._rowCount+=i.data.length);var s=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(I)global.postMessage({results:i,workerId:C.WORKER_ID,finished:s});else if(m(this._config.chunk)&&!e){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return;i=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!m(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}},this._sendError=function(t){m(this._config.error)?this._config.error(t):I&&this._config.error&&global.postMessage({workerId:C.WORKER_ID,error:t,finished:!1})}}function o(t){function e(t){var e=t.getResponseHeader("Content-Range");return null===e?-1:parseInt(e.substr(e.lastIndexOf("/")+1))}t=t||{},t.chunkSize||(t.chunkSize=C.RemoteChunkSize),n.call(this,t);var o;S?this._nextChunk=function(){this._readChunk(),this._chunkLoaded()}:this._nextChunk=function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)return void this._chunkLoaded();if(o=new XMLHttpRequest,this._config.withCredentials&&(o.withCredentials=this._config.withCredentials),S||(o.onload=E(this._chunkLoaded,this),o.onerror=E(this._chunkError,this)),o.open("GET",this._input,!S),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var e in t)o.setRequestHeader(e,t[e])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;o.setRequestHeader("Range","bytes="+this._start+"-"+n),o.setRequestHeader("If-None-Match","webkit-no-cache")}try{o.send()}catch(t){this._chunkError(t.message)}S&&0===o.status?this._chunkError():this._start+=this._config.chunkSize},this._chunkLoaded=function(){if(4===o.readyState){if(o.status<200||o.status>=400)return void this._chunkError();this._finished=!this._config.chunkSize||this._start>e(o),this.parseChunk(o.responseText)}},this._chunkError=function(t){var e=o.statusText||t;this._sendError(new Error(e))}}function i(t){t=t||{},t.chunkSize||(t.chunkSize=C.LocalChunkSize),n.call(this,t);var e,o,i="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,o=t.slice||t.webkitSlice||t.mozSlice,i?(e=new FileReader,e.onload=E(this._chunkLoaded,this),e.onerror=E(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);t=o.call(t,this._start,n)}var r=e.readAsText(t,this._config.encoding);i||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function r(t){t=t||{},n.call(this,t);var e;this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,n=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(n)}}}function s(t){t=t||{},n.call(this,t);var e=[],o=!0,i=!1;this.pause=function(){n.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){n.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===e.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):o=!0},this._streamData=E(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),o&&(o=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=E(function(t){this._streamCleanUp(),this._sendError(t)},this),this._streamEnd=E(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=E(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function a(t){var e=require("stream").Duplex,o=k(t),i=!0,r=!1,s=[],a=null;this._onCsvData=function(t){for(var e=t.data,n=0;n<e.length;n++)a.push(e[n])||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){a.push(null)},o.step=E(this._onCsvData,this),o.complete=E(this._onCsvComplete,this),n.call(this,o),this._nextChunk=function(){r&&1===s.length&&(this._finished=!0),s.length?s.shift()():i=!0},this._addToParseQueue=function(t,e){s.push(E(function(){if(this.parseChunk("string"==typeof t?t:t.toString(o.encoding)),m(e))return e()},this)),i&&(i=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(t,e,n){this._addToParseQueue(t,n)},this._onWriteComplete=function(){r=!0,this._addToParseQueue("")},this.getStream=function(){return a},a=new e({readableObjectMode:!0,decodeStrings:!1,read:E(this._onRead,this),write:E(this._onWrite,this)}),a.once("finish",E(this._onWriteComplete,this))}function d(t){function e(){if(D&&p&&(u("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+C.DefaultDelimiter+"'"),p=!1),t.skipEmptyLines)for(var e=0;e<D.data.length;e++)1===D.data[e].length&&""===D.data[e][0]&&D.data.splice(e--,1);return n()&&o(),s()}function n(){return t.header&&0===T.length}function o(){if(D){for(var e=0;n()&&e<D.data.length;e++)for(var o=0;o<D.data[e].length;o++){var i=D.data[e][o];t.trimHeaders&&(i=i.trim()),T.push(i)}D.data.splice(0,1)}}function i(e){return t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),(t.dynamicTyping[e]||t.dynamicTyping)===!0}function r(t,e){return i(t)?"true"===e||"TRUE"===e||"false"!==e&&"FALSE"!==e&&(g.test(e)?parseFloat(e):h.test(e)?new Date(e):""===e?null:e):e}function s(){if(!D||!t.header&&!t.dynamicTyping&&!t.transform)return D;for(var e=0;e<D.data.length;e++){var n,o=t.header?{}:[];for(n=0;n<D.data[e].length;n++){var i=n,s=D.data[e][n];t.header&&(i=n>=T.length?"__parsed_extra":T[n]),t.transform&&(s=t.transform(s,i)),s=r(i,s),"__parsed_extra"===i?(o[i]=o[i]||[],o[i].push(s)):o[i]=s}D.data[e]=o,t.header&&(n>T.length?u("FieldMismatch","TooManyFields","Too many fields: expected "+T.length+" fields but parsed "+n,S+e):n<T.length&&u("FieldMismatch","TooFewFields","Too few fields: expected "+T.length+" fields but parsed "+n,S+e))}return t.header&&D.meta&&(D.meta.fields=T),S+=D.data.length,D}function a(e,n,o,i){for(var r,s,a,d=[",","\t","|",";",C.RECORD_SEP,C.UNIT_SEP],u=0;u<d.length;u++){var l=d[u],f=0,p=0,g=0;a=void 0;for(var h=new c({comments:i,delimiter:l,newline:n,preview:10}).parse(e),k=0;k<h.data.length;k++)if(o&&1===h.data[k].length&&0===h.data[k][0].length)g++;else{var E=h.data[k].length;p+=E,"undefined"!=typeof a?E>1&&(f+=Math.abs(E-a),a=E):a=E}h.data.length>0&&(p/=h.data.length-g),("undefined"==typeof s||f<s)&&p>1.99&&(s=f,r=l)}return t.delimiter=r,{successful:!!r,bestDelimiter:r}}function d(t){t=t.substr(0,1048576);var e=t.split("\r"),n=t.split("\n"),o=n.length>1&&n[0].length<e[0].length;if(1===e.length||o)return"\n";for(var i=0,r=0;r<e.length;r++)"\n"===e[r][0]&&i++;return i>=e.length/2?"\r\n":"\r"}function u(t,e,n,o){D.errors.push({type:t,code:e,message:n,row:o})}var l,f,p,g=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,h=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,E=this,y=0,S=0,I=!1,v=!1,T=[],D={data:[],errors:[],meta:{}};if(m(t.step)){var R=t.step;t.step=function(o){if(D=o,n())e();else{if(e(),0===D.data.length)return;y+=o.data.length,t.preview&&y>t.preview?f.abort():R(D,E)}}}this.parse=function(n,o,i){if(t.newline||(t.newline=d(n)),p=!1,t.delimiter)m(t.delimiter)&&(t.delimiter=t.delimiter(n),D.meta.delimiter=t.delimiter);else{var r=a(n,t.newline,t.skipEmptyLines,t.comments);r.successful?t.delimiter=r.bestDelimiter:(p=!0,t.delimiter=C.DefaultDelimiter),D.meta.delimiter=t.delimiter}var s=k(t);return t.preview&&t.header&&s.preview++,l=n,f=new c(s),D=f.parse(l,o,i),e(),I?{meta:{paused:!0}}:D||{meta:{paused:!1}}},this.paused=function(){return I},this.pause=function(){I=!0,f.abort(),l=l.substr(f.getCharIndex())},this.resume=function(){I=!1,E.streamer.parseChunk(l,!0)},this.aborted=function(){return v},this.abort=function(){v=!0,f.abort(),D.meta.aborted=!0,m(t.complete)&&t.complete(D),l=""}}function c(t){t=t||{};var e,n=t.delimiter,o=t.newline,i=t.comments,r=t.step,s=t.preview,a=t.fastMode;e=void 0===t.quoteChar?'"':t.quoteChar;var d=e;if(void 0!==t.escapeChar&&(d=t.escapeChar),("string"!=typeof n||C.BAD_DELIMITERS.indexOf(n)>-1)&&(n=","),i===n)throw"Comment character same as delimiter";i===!0?i="#":("string"!=typeof i||C.BAD_DELIMITERS.indexOf(i)>-1)&&(i=!1),"\n"!==o&&"\r"!==o&&"\r\n"!==o&&(o="\n");var c=0,u=!1;this.parse=function(t,l,f){function p(t){C.push(t),b=c}function g(e){var n=0;if(e!==-1){var o=t.substring(A+1,e);o&&""===o.trim()&&(n=o.length)}return n}function h(e){return f?E():("undefined"==typeof e&&(e=t.substr(c)),O.push(e),c=S,p(O),D&&y(),E())}function k(e){c=e,p(O),O=[],x=t.indexOf(o,c)}function E(t){return{data:C,errors:R,meta:{delimiter:n,linebreak:o,aborted:u,truncated:!!t,cursor:b+(l||0)}}}function y(){r(E()),C=[],R=[]}if("string"!=typeof t)throw"Input must be a string";var S=t.length,I=n.length,v=o.length,T=i.length,D=m(r);c=0;var C=[],R=[],O=[],b=0;if(!t)return E();if(a||a!==!1&&t.indexOf(e)===-1){for(var _=t.split(o),F=0;F<_.length;F++){if(O=_[F],c+=O.length,F!==_.length-1)c+=o.length;else if(f)return E();if(!i||O.substr(0,T)!==i){if(D){if(C=[],p(O.split(n)),y(),u)return E()}else p(O.split(n));if(s&&F>=s)return C=C.slice(0,s),E(!0)}}return E()}for(var A,w=t.indexOf(n,c),x=t.indexOf(o,c),P=new RegExp(d.replace(/[-[\]\/{}()*+?.\\^$|]/g,"\\$&")+e,"g");;)if(t[c]!==e)if(i&&0===O.length&&t.substr(c,T)===i){if(x===-1)return E();c=x+v,x=t.indexOf(o,c),w=t.indexOf(n,c)}else if(w!==-1&&(w<x||x===-1))O.push(t.substring(c,w)),c=w+I,w=t.indexOf(n,c);else{if(x===-1)break;if(O.push(t.substring(c,x)),k(x+v),D&&(y(),u))return E();if(s&&C.length>=s)return E(!0)}else for(A=c,c++;;){if(A=t.indexOf(e,A+1),A===-1)return f||R.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:C.length,index:c}),h();if(A===S-1){var N=t.substring(c,A).replace(P,e);return h(N)}if(e!==d||t[A+1]!==d){if(e===d||0===A||t[A-1]!==d){var L=g(w);if(t[A+1+L]===n){O.push(t.substring(c,A).replace(P,e)),c=A+1+L+I,w=t.indexOf(n,c),x=t.indexOf(o,c);break}var M=g(x);if(t.substr(A+1+M,v)===o){if(O.push(t.substring(c,A).replace(P,e)),k(A+1+M+v),w=t.indexOf(n,c),D&&(y(),u))return E();if(s&&C.length>=s)return E(!0);break}R.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:C.length,index:c}),A++}}else A++}return h()},this.abort=function(){u=!0},this.getCharIndex=function(){return c}}function u(){var t=document.getElementsByTagName("script");return t.length?t[t.length-1].src:""}function l(){if(!C.WORKERS_SUPPORTED)return!1;if(!v&&null===C.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=C.SCRIPT_PATH||y;t+=(t.indexOf("?")!==-1?"&":"?")+"papaworker";var e=new global.Worker(t);return e.onmessage=f,e.id=D++,T[e.id]=e,e}function f(t){var e=t.data,n=T[e.workerId],o=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var i=function(){o=!0,p(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},r={abort:i,pause:g,resume:g};if(m(n.userStep)){for(var s=0;s<e.results.data.length&&(n.userStep({data:[e.results.data[s]],errors:e.results.errors,meta:e.results.meta},r),!o);s++);delete e.results}else m(n.userChunk)&&(n.userChunk(e.results,r,e.file),delete e.results)}e.finished&&!o&&p(e.workerId,e.results)}function p(t,e){var n=T[t];m(n.userComplete)&&n.userComplete(e),n.terminate(),delete T[t]}function g(){throw"Not implemented."}function h(t){var e=t.data;if("undefined"==typeof C.WORKER_ID&&e&&(C.WORKER_ID=e.workerId),"string"==typeof e.input)global.postMessage({workerId:C.WORKER_ID,results:C.parse(e.input,e.config),finished:!0});else if(global.File&&e.input instanceof File||e.input instanceof Object){var n=C.parse(e.input,e.config);n&&global.postMessage({workerId:C.WORKER_ID,results:n,finished:!0})}}function k(t){if("object"!=typeof t||null===t)return t;var e=t instanceof Array?[]:{};for(var n in t)e[n]=k(t[n]);return e}function E(t,e){return function(){t.apply(e,arguments)}}function m(t){return"function"==typeof t}var y,S=!global.document&&!!global.postMessage,I=S&&/(\?|&)papaworker(=|&|$)/.test(global.location.search),v=!1,T={},D=0,C={};if(C.parse=t,C.unparse=e,C.RECORD_SEP=String.fromCharCode(30),C.UNIT_SEP=String.fromCharCode(31),C.BYTE_ORDER_MARK="\ufeff",C.BAD_DELIMITERS=["\r","\n",'"',C.BYTE_ORDER_MARK],C.WORKERS_SUPPORTED=!S&&!!global.Worker,C.SCRIPT_PATH=null,C.NODE_STREAM_INPUT=1,C.LocalChunkSize=10485760,C.RemoteChunkSize=5242880,C.DefaultDelimiter=",",C.Parser=c,C.ParserHandle=d,C.NetworkStreamer=o,C.FileStreamer=i,C.StringStreamer=r,C.ReadableStreamStreamer=s,C.DuplexStreamStreamer=a,global.jQuery){var R=global.jQuery;R.fn.parse=function(t){function e(){if(0===r.length)return void(m(t.complete)&&t.complete());var e=r[0];if(m(t.before)){var i=t.before(e.file,e.inputElem);if("object"==typeof i){if("abort"===i.action)return void n("AbortError",e.file,e.inputElem,i.reason);if("skip"===i.action)return void o();"object"==typeof i.config&&(e.instanceConfig=R.extend(e.instanceConfig,i.config))}else if("skip"===i)return void o()}var s=e.instanceConfig.complete;e.instanceConfig.complete=function(t){m(s)&&s(t,e.file,e.inputElem),o()},C.parse(e.file,e.instanceConfig)}function n(e,n,o,i){m(t.error)&&t.error({name:e},n,o,i)}function o(){r.splice(0,1),e()}var i=t.config||{},r=[];return this.each(function(t){var e="INPUT"===R(this).prop("tagName").toUpperCase()&&"file"===R(this).attr("type").toLowerCase()&&global.FileReader;if(!e||!this.files||0===this.files.length)return!0;for(var n=0;n<this.files.length;n++)r.push({file:this.files[n],inputElem:this,instanceConfig:R.extend({},i)})}),e(),this}}return I?global.onmessage=h:C.WORKERS_SUPPORTED&&(y=u(),document.body?document.addEventListener("DOMContentLoaded",function(){v=!0},!0):v=!0),o.prototype=Object.create(n.prototype),o.prototype.constructor=o,i.prototype=Object.create(n.prototype),i.prototype.constructor=i,r.prototype=Object.create(r.prototype),r.prototype.constructor=r,s.prototype=Object.create(n.prototype),s.prototype.constructor=s,a.prototype=Object.create(n.prototype),a.prototype.constructor=a,C}),SkyEditor.CreateSelectFolderPopup=METHOD({run:(t,e)=>{let n,o,i,r=(e,o)=>{let i=SkyEditor.Folder({path:e,title:o,isOpened:t.get(e),on:{open:()=>{s(e,i,i.close)},close:()=>{i.removeAllItems()},tap:()=>{n=e}}});return i},s=(t,e,n)=>{SkyEditor.IDE.loadFiles(t,(o,i,s)=>{let a=0;RUN(n=>{let s=0;for(;a<o.length;){let n=o[a],i=r(t+"/"+n,n);if(""===t&&(i.setIcon(IMG({src:SkyEditor.R("icon/project.png")})),i.on("open",()=>{i.setIcon(IMG({src:SkyEditor.R("icon/project-opened.png")}))}),i.on("close",()=>{i.setIcon(IMG({src:SkyEditor.R("icon/project.png")}))})),e.addItem({key:t+"/"+n,item:i}),a+=1,s+=1,""!==t&&50===s)break}""!==t&&50===s&&e.addItem({key:"__MORE_BUTTON",item:SkyEditor.More({title:"더 보기...",on:{tap:()=>{n()}}})}),a===o.length+i.length&&e.removeItem("__MORE_BUTTON")}),s===!0&&n()})};SkyDesktop.Confirm({okButtonTitle:"저장",style:{onDisplayResize:(t,e)=>{return t>600?{width:500}:{width:"90%"}}},msg:[H2({style:{fontWeight:"bold"},c:"저장할 경로를 선택해주세요."}),o=SkyDesktop.FileTree({style:{marginTop:8,overflowY:"scroll",padding:8,backgroundColor:"#000",borderRadius:4,textAlign:"left",color:"#fff",onDisplayResize:(t,e)=>{return e>500?{height:300}:{height:150}}}}),i=UUI.FULL_INPUT({style:{marginTop:10,border:"1px solid #999",borderRadius:4,fontSize:18},placeholder:"파일 명"})]},()=>{void 0===n?SkyDesktop.Alert({msg:"저장할 경로를 선택해주세요."}):e(n+"/"+i.getValue())});let a=r("","작업 폴더");a.setIcon(IMG({src:SkyEditor.R("icon/project.png")})),a.on("open",()=>{a.setIcon(IMG({src:SkyEditor.R("icon/project-opened.png")}))}),a.on("close",()=>{a.setIcon(IMG({src:SkyEditor.R("icon/project.png")}))}),o.addItem({key:"",item:a}),s("",a),a.open()}}),SkyEditor.Editor=CLASS({preset:()=>{return SkyDesktop.Tab},init:(t,e,n)=>{let o,i=n.ftpInfo,r=n.path,s=n.content,a=s,d=e.getTitle();e.getFTPInfo=(()=>{return i}),e.setFTPInfo=(t=>{i=t}),e.getPath=(()=>{return r}),e.setPath=(t=>{if(void 0===i){let e=SkyEditor.IDE.getEditorOpenedStore();e.remove(r),e.save({name:t,value:!0})}r=t}),e.getContent=(()=>{return s}),e.setContent=(t=>{s=t,e.fireEvent("change")}),e.setOriginContent=(t=>{a=t,e.fireEvent("change")}),e.setScrollTop=(t=>{}),e.setFindText=(t=>{});OVERRIDE(e.setTitle,t=>{o=e.setTitle=(t=>{d=t,e.fireEvent("titlechange")}),e.on("change",()=>{t(e.getContent()!==a?"* "+d:d)})});let c;OVERRIDE(e.getTitle,t=>{c=e.getTitle=(()=>{return d})}),e.on("close",()=>{if(e.getContent()!==a&&(""!==e.getContent()||void 0!==a))return SkyDesktop.Confirm({msg:"저장하지 않았습니다. 정말 종료 하시겠습니까?"},()=>{e.remove()}),!1});let u=!0;e.on("active",()=>{void 0!==r&&(u!==!0&&SkyEditor.IDE.load({ftpInfo:i,path:r,isReload:!0},t=>{e.getContent()!==t&&e.getContent()===a&&(e.setContent(t),e.setOriginContent(t))}),u=!1)})}}),SkyEditor.HomeTab=CLASS(t=>{let e,n=t.remove=(()=>{void 0!==e&&e.remove()});return global.addEventListener("message",t=>{"__CLOSE_HOME_TAB"===t.data&&n()},!1),{preset:()=>{return SkyDesktop.Tab},params:()=>{return{icon:IMG({src:SkyEditor.R("icon/home.png")}),title:"홈"}},init:(t,n,o)=>{n.append(DIV({style:{width:"100%",height:"100%",overflow:"hidden"},c:IFRAME({style:{backgroundColor:"#fff",width:"100%",height:"100%"},src:o})})),void 0!==e&&e.remove(),e=n,n.on("remove",()=>{e=void 0})}}}),SkyEditor.IDE=OBJECT({preset:()=>{return DIV},params:()=>{return{style:{position:"absolute",width:"100%",height:"100%",overflow:"hidden"}}},init:(t,e)=>{let n,o,i,r,s,a,d,c,u,l,f,p,g,h,k,E,m,y,S,I,v,T,D,C,R,O,b,_,F,w,x,N,L,M,U,B={},G=SkyEditor.STORE("editorSettingStore"),H=SkyEditor.STORE("editorOpenedStore"),W=SkyEditor.STORE("gitInfoStore"),V={},z=[],K=TABLE({style:{height:"100%"}}).appendTo(e),j=(e.addEditor=(t=>{let e=t.extname,n=t.editor;void 0===B[e]&&(B[e]=[]),B[e].push(n)}),e.getEditor=(t=>{let e=SkyEditor.TextEditor;if(void 0!==G){let n=G.get(t);void 0!==B[t]&&EACH(B[t],t=>{if(void 0===n||t.getName()===n)return e=t,!1})}return e}));e.getEditorOpenedStore=(()=>{return H});K.append(TR({c:TD({style:{height:28},c:U=SkyDesktop.Toolbar({buttons:[SkyDesktop.ToolbarButton({icon:IMG({src:SkyEditor.R("icon/home.png")}),title:"홈",on:{tap:()=>{n()}}}),SkyDesktop.ToolbarButton({icon:IMG({src:SkyDesktop.R("file.png")}),title:"새 파일",on:{tap:()=>{nt(SkyEditor.TextEditor({title:"제목 없음"}))}}}),SkyDesktop.ToolbarButton({icon:IMG({src:SkyEditor.R("icon/save.png")}),title:"저장",on:{tap:()=>{let t=et.getActiveTab();t.checkIsInstanceOf(SkyEditor.Editor)===!0&&ft(t)}}}),SkyDesktop.ToolbarButton({icon:IMG({src:SkyEditor.R("icon/git.png")}),title:"Git Clone",on:{tap:()=>{let t,e;SkyDesktop.Confirm({okButtonTitle:"저장",msg:t=UUI.VALID_FORM({errorMsgs:{folderName:{notEmpty:"저장할 폴더명을 입력해주세요."},url:{notEmpty:"저장소 URL을 입력해주세요."},username:{notEmpty:"아이디를 입력해주세요."},password:{notEmpty:"비밀번호를 입력해주세요."}},errorMsgStyle:{color:"red"},c:[e=INPUT({style:{width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"folderName",placeholder:"저장할 폴더명"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"url",placeholder:"저장소 URL"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"username",placeholder:"아이디"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},type:"password",name:"password",placeholder:"비밀번호"})]})},()=>{let e=t.getData(),n=VALID({folderName:{notEmpty:!0},url:{notEmpty:!0},username:{notEmpty:!0},password:{notEmpty:!0}}),o=n.check(e);if(o.checkHasError()===!0)return t.showErrors(o.getErrors()),!1;{let t=SkyEditor.IDE.getWorkspacePath()+"/"+e.folderName;ut({path:t},n=>{if(n===!0)SkyDesktop.Alert({msg:"이미 존재하는 폴더입니다. 다른 폴더를 지정해주세요."});else{let n=SkyDesktop.LoadingBar("lime");St({path:t,url:e.url,username:e.username,password:e.password},{error:t=>{n.done(),SkyDesktop.Alert({msg:t})},success:()=>{n.done(),W.save({name:t,value:e}),SkyDesktop.Noti("Clone 완료")}})}})}}),e.focus()}}}),SkyDesktop.ToolbarButton({icon:IMG({src:SkyEditor.R("icon/setting.png")}),title:"에디터 설정",on:{tap:()=>{let t;SkyDesktop.Confirm({okButtonTitle:"저장",style:{onDisplayResize:(t,e)=>{return t>600?{width:500}:{width:"90%"}}},msg:[H2({style:{fontWeight:"bold"},c:"에디터 설정"}),t=DIV({style:{marginTop:8,overflowY:"scroll",padding:8,backgroundColor:"#e0e1e2",border:"1px solid #999",borderRadius:4,textAlign:"left",onDisplayResize:(t,e)=>{return e>500?{height:300}:{height:150}}}})]},()=>{}),EACH(B,(e,n)=>{let o=DIV({style:{padding:"5px 8px",backgroundColor:"#fff",border:"1px solid #999",borderRadius:4,marginBottom:10},c:H3({style:{marginBottom:5},c:[SPAN({style:{fontWeight:"bold"},c:n})," 파일 에디터 선택"]})}).appendTo(t);EACH(e,(t,e)=>{let i;o.append(P({c:[i=INPUT({style:{marginTop:2,flt:"left"},type:"radio",name:n,value:void 0===G.get(n)&&0===e||G.get(n)===t.getName(),on:{change:()=>{G.save({name:n,value:t.getName()})}}}),UUI.BUTTON_H({style:{marginLeft:5,flt:"left"},icon:t.getIcon(),spacing:5,title:t.getName(),on:{tap:()=>{i.toggleCheck()}}}),CLEAR_BOTH()]}))})})}}})]})})}));let Y,q,X,J,$,Q,Z,tt,et,nt=(e.addToolbarButton=(t=>{U.addButton(t)}),e.removeToolbarButton=(t=>{U.removeButton(t)}),e.openEditor=(t=>{return et.addTab(t),t.checkIsInstanceOf(SkyEditor.Editor)===!0&&t.checkIsInstanceOf(SkyEditor.CompareEditor)!==!0&&void 0===t.getFTPInfo()&&(t.on("scroll",RAR(e=>{H.save({name:t.getPath(),value:t.getScrollTop()})})),t.on("close",()=>{H.remove(t.getPath()),void 0!==Q&&0===et.getAllTabs().length&&(J.setSize(Q),Q=void 0)})),t})),ot=(e.closeAllEditors=(()=>{et.removeAllTabs()}),(t,e,n)=>{Dt();let o=!1;EACH(et.getAllTabs(),(i,r)=>{if(i.checkIsInstanceOf(SkyEditor.Editor)===!0&&void 0===i.getFTPInfo()&&i.getPath()===t)return o=!0,et.activeTab(r),void 0!==e&&et.getActiveTab().setScrollTop(e),void 0!==n&&et.getActiveTab().setFindText(n),!1}),o!==!0&&ct({path:t},o=>{let i=t.substring(t.lastIndexOf("/")+1),r=nt(j(i.substring(i.lastIndexOf(".")+1).toLowerCase())({title:i,path:t,content:o}));void 0!==e&&r.setScrollTop(e),void 0!==n&&r.setFindText(n)})});K.append(TR({c:TD({style:{height:"100%"},c:SkyDesktop.HorizontalTabList({tabs:[J=SkyDesktop.Tab({style:{overflow:"hidden"},size:23,on:{settowidth:()=>{J.addStyle({width:J.getToWidth()}),Z.addStyle({width:J.getToWidth()}),tt.addStyle({width:J.getToWidth()})}},c:$=SkyDesktop.TabGroup({activeTabIndex:0,tabs:[Z=SkyDesktop.Tab({isCannotClose:!0,icon:IMG({src:SkyEditor.R("icon/workspace.png")}),title:"작업 폴더",c:Y=SkyDesktop.FileTree(ot),on:{contextmenu:t=>{SkyEditor.FileContextMenu({folderPath:x,e:t}),t.stop()}}}),tt=SkyDesktop.Tab({isCannotClose:!0,icon:IMG({src:SkyEditor.R("icon/ftp.png")}),title:"FTP",c:[UUI.BUTTON_H({style:{position:"relative",marginLeft:20,padding:"2px 5px"},icon:IMG({src:SkyEditor.R("icon/ftp.png")}),title:"새 FTP 연결",spacing:5,c:UUI.ICON_BUTTON({style:{position:"absolute",left:-12,top:3,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"},icon:FontAwesome.GetIcon("plus"),on:{mouseover:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#999"}),t.stop()},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"}),t.stop()}}}),on:{tap:t=>{let e,n,o;SkyDesktop.Confirm({okButtonTitle:"저장",msg:e=UUI.VALID_FORM({errorMsgs:{title:{notEmpty:"사이트 이름을 입력해주세요."},host:{notEmpty:"호스트를 입력해주세요."},username:{notEmpty:"아이디를 입력해주세요."}},errorMsgStyle:{color:"red"},c:[INPUT({style:{width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"title",placeholder:"사이트 이름"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"host",placeholder:"호스트"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"port",placeholder:"포트 번호"}),SELECT({style:{marginTop:10,width:240,padding:8,border:"1px solid #999",borderRadius:4},name:"protocol",c:[OPTION({value:"ftp",c:"FTP"}),OPTION({value:"sftp",c:"SFTP"})],on:{change:(t,e)=>{"sftp"===e.getValue()?o.show():o.hide()}}}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"username",placeholder:"로그인 아이디"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},type:"password",name:"password",placeholder:"비밀번호"}),o=DIV({style:{display:"none",marginTop:10},c:[H3({c:"Private Key"}),INPUT({style:{marginTop:5,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"privateKey",type:"file",on:{change:(t,e)=>{let o=new FileReader;o.readAsText(e.getFiles()[0]),o.onload=(t=>{n=t.target.result})}}})]})]})},()=>{let t=e.getData();if(VALID.notEmpty(t.password)!==!0&&void 0===n)return SkyDesktop.Alert({msg:"비밀번호를 입력해주세요."}),!1;{t.privateKey=n;let o=VALID({title:{notEmpty:!0},host:{notEmpty:!0},username:{notEmpty:!0}}),i=o.check(t);if(i.checkHasError()===!0)return e.showErrors(i.getErrors()),!1;{let e=SkyDesktop.LoadingBar("lime");mt(t,()=>{it(t),e.done()})}}}),t.stop()}}}),q=SkyDesktop.FileTree()]})]})}),SkyDesktop.Tab({style:{overflow:"hidden"},size:77,c:X=SkyDesktop.VerticalTabList({tabs:[SkyDesktop.Tab({size:70,c:et=SkyDesktop.TabGroup({on:{titledoubletap:()=>{void 0===Q?(Q=J.getSize(),J.setSize(0)):(J.setSize(Q),Q=void 0)},tap:()=>{Dt()}}})})]})})]})})}));let it=(e.getFileTreeTab=(()=>{return Z}),e.addItem=(t=>{Y.addItem(t)}),e.addFTPItem=(t=>{let e;q.addItem({key:t.username+"@"+t.host,item:e=SkyEditor.FTPItem(t)}),e.on("open",()=>{let n=SkyDesktop.LoadingBar("lime");h(t,o=>{console.log(o),n.done(),SkyDesktop.Alert({msg:t.title+" 접속에 실패하였습니다."}),e.close()},()=>{n.done(),yt(t,e,".")})})})),rt=e.getFTPItem=((t,e)=>{let n,o="";return EACH(e.split("/"),e=>{""===o&&"."===e?(o=e,n=q.getItem(t.username+"@"+t.host)):(o+="/"+e,n=n.getItem(o))}),n}),st=(e.getItem=(t=>{return Y.getItem(t)}),e.removeItem=(t=>{Y.removeItem(t)}),e.clearFileTree=(()=>{Y.removeAllItems()}),[]);EACH(H.all(),(t,e)=>{st.push({path:e,scrollTop:t})});let at,dt=e.loadFiles=((t,e)=>{let n=SkyDesktop.LoadingBar("lime");i(t,()=>{SkyDesktop.Alert({msg:t+"의 파일 목록을 불러오는데 실패하였습니다."})},(t,o,i)=>{n.done(),e(t,o,i)})}),ct=e.load=((t,e)=>{let n=t.ftpInfo,i=t.path,r=t.isReload;if(Dt(),void 0!==n){let t;r!==!0&&(t=SkyDesktop.LoadingBar("lime")),k(n,i,()=>{void 0!==t&&t.done(),SkyDesktop.Alert({msg:"FTP로부터 파일을 불러오는데 실패하였습니니다."})},n=>{void 0!==t&&t.done(),e(n)})}else o(i,()=>{SkyDesktop.Alert({msg:"파일을 불러오는데 실패하였습니니다."})},e)}),ut=e.checkExists=((t,e)=>{let n=t.ftpInfo,o=t.path;if(void 0!==n){let t=SkyDesktop.LoadingBar("lime");D(n,o,()=>{SkyDesktop.Alert({msg:"파일이 존재하는지 확인하는데 실패하였습니다."})},n=>{t.done(),e(n)})}else l(o,e)}),lt=e.save=((t,e)=>{let n=t.ftpInfo,o=t.path,i=t.content,s=t.buffer,a=t.isFindAndReplace;if(void 0!==i&&i.length<1048576){let t=Et({ftpInfo:n,path:o});void 0===t&&(t=[]),0!==t.length&&t[t.length-1].content===i||(t.push({time:new Date,content:i}),V[STRINGIFY({ftpInfo:n,path:o})]=t)}if(void 0!==n){let t=SkyDesktop.LoadingBar("lime");m(n,o,i,()=>{t.done(),SkyDesktop.Alert({msg:"FTP로 파일을 저장하는데 실패하였습니니다."})},()=>{t.done();let i=o.substring(o.lastIndexOf("/")+1);rt(n,o.substring(0,o.lastIndexOf("/"))).addItem({key:o,item:SkyEditor.File({ftpInfo:n,path:o,title:i,on:{doubletap:()=>{let t=SkyDesktop.LoadingBar("lime");k(n,o,()=>{t.done(),SkyDesktop.Alert({msg:o+"의 파일 목록을 불러오는데 실패하였습니다."})},e=>{t.done(),nt(j(i.substring(i.lastIndexOf(".")+1).toLowerCase())({ftpInfo:n,title:i,path:o,content:e}))})}}})}),void 0!==e&&e(o)});
}else r(o,i,s,()=>{SkyDesktop.Alert({msg:"파일 저장에 실패하였습니니다."})},e,a)}),ft=e.saveTab=(t=>{t.checkIsInstanceOf(SkyEditor.GitEditor)===!0||(t.checkIsInstanceOf(SkyEditor.CompareEditor)===!0?lt({ftpInfo:t.getFTPInfo(),path:t.getPath1(),content:t.getContent1()},()=>{void 0!==t.getPath2()?lt({ftpInfo:t.getFTPInfo(),path:t.getPath2(),content:t.getContent2()},()=>{t.fireEvent("save"),SkyDesktop.Noti("저장하였습니다.")}):(t.fireEvent("save"),SkyDesktop.Noti("저장하였습니다."))}):lt({ftpInfo:t.getFTPInfo(),path:t.getPath(),content:t.getContent()},e=>{t.setPath(e);let n=e.substring(e.lastIndexOf("/")+1),o=n.substring(n.lastIndexOf(".")+1).toLowerCase(),i=j(o);void 0!==i&&t.setIcon(i.getIcon()),t.fireEvent("save"),SkyDesktop.Noti("저장하였습니다."),t.setOriginContent(t.getContent()),t.setTitle(n),void 0===t.getFTPInfo()&&H.save({name:t.getPath(),value:t.getScrollTop()})}))}),pt=(e.createFolder=(t=>{let e=t.ftpInfo,n=t.path;if(void 0!==e){let t=SkyDesktop.LoadingBar("lime");y(e,n,()=>{t.done(),SkyDesktop.Alert({msg:"FTP로 폴더를 생성하는데 실패하였습니니다."})},()=>{t.done();let o,i=n.substring(n.lastIndexOf("/")+1);rt(e,n.substring(0,n.lastIndexOf("/"))).addItem({key:n,item:o=SkyEditor.Folder({ftpInfo:e,path:n,title:i,on:{open:()=>{yt(e,o,n)}}})})})}else s(n,()=>{SkyDesktop.Alert({msg:"폴더 생성에 실패하였습니니다."})},()=>{})}),e.copy=(t=>{_(t)})),gt=e.paste=(t=>{let e=t.ftpInfo,n=t.folderPath,o=SkyDesktop.LoadingBar("lime");F(e,n,()=>{SkyDesktop.Alert({msg:"붙여넣기에 실패하였습니니다."})},(t,n)=>{o.done(),void 0!==e&&(EACH(t,t=>{let n,o=t.substring(t.lastIndexOf("/")+1);rt(e,t.substring(0,t.lastIndexOf("/"))).addItem({key:t,item:n=SkyEditor.Folder({ftpInfo:e,path:t,title:o,on:{open:()=>{yt(e,n,t)}}})})}),EACH(n,t=>{let n=t.substring(t.lastIndexOf("/")+1);rt(e,t.substring(0,t.lastIndexOf("/"))).addItem({key:t,item:SkyEditor.File({ftpInfo:e,path:t,title:n,on:{doubletap:()=>{let o=SkyDesktop.LoadingBar("lime");k(e,t,()=>{o.done(),SkyDesktop.Alert({msg:t+"의 파일 목록을 불러오는데 실패하였습니다."})},i=>{o.done(),nt(j(n.substring(n.lastIndexOf(".")+1).toLowerCase())({ftpInfo:e,title:n,path:t,content:i}))})}}})})}))})}),ht=e.remove=(t=>{let e=t.ftpInfo,n=t.path,i=It(n);void 0!==i&&i.remove();let r=Y.getItem(n);if(void 0!==r&&Rt(r),void 0!==e){let t=SkyDesktop.LoadingBar("lime");NEXT([t=>{k(e,n,()=>{t()},o=>{z.push({ftpInfo:e,path:n,content:o}),t()})},()=>{return()=>{S(e,n,()=>{t.done(),SkyDesktop.Alert({msg:"FTP에서 파일을 삭제하는데 실패하였습니니다."})},()=>{t.done(),rt(e,n.substring(0,n.lastIndexOf("/"))).removeItem(n)})}}])}else NEXT([t=>{o(n,()=>{t()},o=>{z.push({ftpInfo:e,path:n,content:o}),t()})},()=>{return()=>{a(n,()=>{SkyDesktop.Alert({msg:"파일 삭제에 실패하였습니니다."})},()=>{})}}])}),kt=e.move=(t=>{let e=t.fromFTPInfo,n=t.toFTPInfo,o=t.from,i=t.to,r=SkyDesktop.LoadingBar("lime");NEXT([t=>{ut({ftpInfo:n,path:i},e=>{e===!0?SkyDesktop.Confirm({msg:i.substring(i.lastIndexOf("/")+1)+"이(가) 존재합니다. 덮어쓰시겠습니까?"},{ok:()=>{t()},cancel:()=>{r.done()}}):t()})},()=>{return()=>{void 0!==e||void 0!==n?I(e,n,o,i,()=>{r.done(),SkyDesktop.Alert({msg:"FTP에서 파일 이동에 실패하였습니니다."})},()=>{r.done();let t=It(o);void 0!==t&&(t.setFTPInfo(n),t.setPath(i),t.setTitle(i.substring(i.lastIndexOf("/")+1)));let s=rt(e,o.substring(0,o.lastIndexOf("/")));if(s.getItem(o).checkIsInstanceOf(SkyEditor.Folder)===!0){let t,e=i.substring(i.lastIndexOf("/")+1);rt(n,i.substring(0,i.lastIndexOf("/"))).addItem({key:i,item:t=SkyEditor.Folder({ftpInfo:n,path:i,title:e,on:{open:()=>{yt(n,t,i)}}})})}else{let t=i.substring(i.lastIndexOf("/")+1);rt(n,i.substring(0,i.lastIndexOf("/"))).addItem({key:i,item:SkyEditor.File({ftpInfo:n,path:i,title:t,on:{doubletap:()=>{let e=SkyDesktop.LoadingBar("lime");k(n,i,()=>{e.done(),SkyDesktop.Alert(i+"의 파일 목록을 불러오는데 실패하였습니다.")},o=>{e.done(),nt(j(t.substring(t.lastIndexOf(".")+1).toLowerCase())({ftpInfo:n,title:t,path:i,content:o}))})}}})})}s.removeItem(o)}):d(o,i,()=>{r.done(),SkyDesktop.Alert({msg:"파일 이동에 실패하였습니니다."})},()=>{r.done();let t=It(o);void 0!==t&&(t.setPath(i),t.setTitle(i.substring(i.lastIndexOf("/")+1)));let e=Y.getItem(i);void 0===e?EACH(Y.getItems(),t=>{if(t.checkIsInstanceOf(SkyDesktop.Folder)===!0){let n=t.getItem(i);if(void 0!==n)return e=n,!1}}):e.select()})}}])}),Et=(e.clone=(t=>{let e=t.fromFTPInfo,n=t.toFTPInfo,o=t.from,i=t.to,r=SkyDesktop.LoadingBar("lime");NEXT([t=>{ut({ftpInfo:n,path:i},e=>{e===!0?SkyDesktop.Confirm({msg:i.substring(i.lastIndexOf("/")+1)+"이(가) 존재합니다. 덮어쓰시겠습니까?"},{ok:()=>{t()},cancel:()=>{r.done()}}):t()})},()=>{return()=>{void 0!==e||void 0!==n?v(e,n,o,i,()=>{r.done(),SkyDesktop.Alert({msg:"FTP에서 파일 복사에 실패하였습니니다."})},()=>{r.done();let t=It(o);void 0!==t&&(t.setFTPInfo(n),t.setPath(i),t.setTitle(i.substring(i.lastIndexOf("/")+1)));let s=rt(e,o.substring(0,o.lastIndexOf("/")));if(s.getItem(o).checkIsInstanceOf(SkyEditor.Folder)===!0){let t,e=i.substring(i.lastIndexOf("/")+1);rt(n,i.substring(0,i.lastIndexOf("/"))).addItem({key:i,item:t=SkyEditor.Folder({ftpInfo:n,path:i,title:e,on:{open:()=>{yt(n,t,i)}}})})}else{let t=i.substring(i.lastIndexOf("/")+1);rt(n,i.substring(0,i.lastIndexOf("/"))).addItem({key:i,item:SkyEditor.File({ftpInfo:n,path:i,title:t,on:{doubletap:()=>{let e=SkyDesktop.LoadingBar("lime");k(n,i,()=>{e.done(),SkyDesktop.Alert(i+"의 파일 목록을 불러오는데 실패하였습니다.")},o=>{e.done(),nt(j(t.substring(t.lastIndexOf(".")+1).toLowerCase())({ftpInfo:n,title:t,path:i,content:o}))})}}})})}}):c(o,i,()=>{r.done(),SkyDesktop.Alert({msg:"파일 복사에 실패하였습니니다."})},()=>{r.done();let t=It(o);void 0!==t&&(t.setPath(i),t.setTitle(i.substring(i.lastIndexOf("/")+1)));let e=Y.getItem(i);void 0===e?EACH(Y.getItems(),t=>{if(t.checkIsInstanceOf(SkyDesktop.Folder)===!0){let n=t.getItem(i);if(void 0!==n)return e=n,!1}}):e.select()})}}])}),e.getInfo=((t,e)=>{let n=t.ftpInfo,o=t.path;if(void 0!==n){let t=SkyDesktop.LoadingBar("lime");T(n,o,()=>{t.done(),SkyDesktop.Alert({msg:"FTP로부터 파일 정보를 가져오는데에 실패하였습니니다."})},n=>{t.done(),e(n)})}else u(o,()=>{SkyDesktop.Alert({msg:"파일 정보를 가져오는데에 실패하였습니니다."})},e)}),e.getLocalHistory=(t=>{let e=t.ftpInfo,n=t.path;return V[STRINGIFY({ftpInfo:e,path:n})]})),mt=e.ftpNew=((t,e)=>{f(t,()=>{SkyDesktop.Alert({msg:"FTP 정보 생성에 실패하였습니다."})},()=>{SkyDesktop.Alert({msg:"이미 존재하는 FTP 정보입니다."})},e)}),yt=(e.ftpDestroy=((t,e)=>{p(t,()=>{SkyDesktop.Alert({msg:"FTP 정보 삭제에 실패하였습니다."})},e)}),(t,e,n)=>{let o=SkyDesktop.LoadingBar("lime");E(t,n,()=>{o.done(),SkyDesktop.Alert({msg:n+"의 파일 목록을 불러오는데 실패하였습니다."})},(i,r)=>{o.done(),EACH(i,o=>{let i;e.addItem({key:n+"/"+o,item:i=SkyEditor.Folder({ftpInfo:t,path:n+"/"+o,title:o,on:{open:()=>{yt(t,i,n+"/"+o)}}})})}),EACH(r,o=>{e.addItem({key:n+"/"+o,item:SkyEditor.File({ftpInfo:t,path:n+"/"+o,title:o,on:{doubletap:()=>{let e=SkyDesktop.LoadingBar("lime");k(t,n+"/"+o,()=>{e.done(),SkyDesktop.Alert({msg:n+"/"+o+"의 파일 목록을 불러오는데 실패하였습니다."})},i=>{e.done(),nt(j(o.substring(o.lastIndexOf(".")+1).toLowerCase())({ftpInfo:t,title:o,path:n+"/"+o,content:i}))})}}})})})})}),St=(e.overFileSize=(t=>{w(t.ftpInfo,t.path)}),e.gitClone=((t,e)=>{C(t,e)})),It=(e.gitDiff=((t,e)=>{R(t,e)}),e.gitPush=((t,e)=>{O(t,e)}),e.gitPull=((t,e)=>{b(t,e)}),e.getOpenedEditor=(t=>{let e;return EACH(et.getAllTabs(),n=>{n.checkIsInstanceOf(SkyEditor.Editor)===!0&&n.getPath()===t&&(e=n)}),e})),vt=[],Tt=e.selectMultipleFile=(t=>{CHECK_IS_IN({array:vt,value:t})!==!0&&vt.push(t),t.select()}),Dt=e.deselectFiles=(()=>{EACH(vt,t=>{t.checkIsRemoved()!==!0&&t.deselect()}),vt=[]}),Ct=e.selectFile=(t=>{Dt(),vt.push(t),t.select()}),Rt=e.deselectFile=(t=>{REMOVE({array:vt,value:t}),t.deselect()});e.selectFileRange=(t=>{let e=vt[vt.length-1];if(void 0!==e&&t!==e){let n,o;t.getTop()<e.getTop()?(n=t,o=e):(n=e,o=t),vt=[],Tt(n);let i=t=>{EACH(t,t=>{n.getTop()<t.getTop()&&t.getTop()<o.getTop()&&Tt(t),t.checkIsInstanceOf(SkyEditor.Folder)===!0&&i(t.getItems())})},r=t.getFTPInfo();i(void 0!==r?q.getItem(r.username+"@"+r.host).getItems():Y.getItems()),Tt(o)}}),e.getSelectedFileItems=(()=>{return vt}),e.checkIsControlMode=(()=>{return at});EVENT("keydown",t=>{if(at===!0){let e=t.getKey().toLowerCase();if("n"===e)nt(SkyEditor.TextEditor({title:"제목 없음"}));else if("c"===e){let t=[];EACH(vt,e=>{t.push({ftpInfo:e.getFTPInfo(),path:e.getPath()})}),pt(t)}else if("v"===e)"TEXTAREA"!==document.activeElement.tagName&&"INPUT"!==document.activeElement.tagName&&vt.length>0&&gt({ftpInfo:vt[vt.length-1].getFTPInfo(),folderPath:vt[vt.length-1].getFolderPath()});else if("w"===e||"q"===e)X.getAllTabs().length>1?X.getAllTabs()[1].remove():void 0!==et.getActiveTab()&&et.getActiveTab().fireEvent("close")!==!1&&et.getActiveTab().remove(),EVENT.fireAll("resize");else if("s"===e)void 0!==et.getActiveTab()&&ft(et.getActiveTab()),t.stopDefault();else if("h"===e)0===$.getActiveTabIndex()&&vt.length>0&&(_t(),t.stopDefault());else if("ArrowLeft"===t.getKey()){let t=et.getActiveTabIndex();t>0&&et.activeTab(t-1)}else if("ArrowRight"===t.getKey()){let t=et.getActiveTabIndex();t<et.getAllTabs().length-1&&et.activeTab(t+1)}else if("z"===t.getKey()){let t=z.pop();if(void 0!==t){let e=SkyDesktop.LoadingBar("lime");lt(t,()=>{e.done()})}}}else if("abcdefghijklmnopqrstuvwxyz0123456789".indexOf(t.getKey())!==-1&&vt.length>0){let e=vt[vt.length-1],n=!1;if(e.checkIsInstanceOf(SkyEditor.Folder)===!0&&COUNT_PROPERTIES(e.getItems())>0&&EACH(e.getItems(),e=>{return EACH(e.getParent().getChildren(),e=>{if((e.checkIsInstanceOf(SkyEditor.File)===!0||e.checkIsInstanceOf(SkyEditor.Folder)===!0)&&e.getTitle()[0].toLowerCase()===t.getKey())return n=!0,Ct(e),!1}),!1}),n!==!0){let n;if(REVERSE_EACH(e.getParent().getChildren(),o=>{if(o.checkIsInstanceOf(SkyEditor.File)===!0||o.checkIsInstanceOf(SkyEditor.Folder)===!0){if(o===e)return!1;if(o.getTitle()[0].toLowerCase()===t.getKey())return n=o,!1}}),void 0===n){if(e.getParent()!==Y){let n;REVERSE_EACH(e.getParent().getParent().getChildren(),o=>{if(o.checkIsInstanceOf(SkyEditor.File)===!0||o.checkIsInstanceOf(SkyEditor.Folder)===!0){if(o===e.getParent())return!1;o.getTitle()[0].toLowerCase()===t.getKey()&&(n=o)}}),void 0!==n&&(Rt(e),Ct(n))}}else Rt(e),Ct(n)}}if("Control"!==t.getKey()&&"Meta"!==t.getKey()||(at=!0,void 0!==N&&void 0===L&&N.append(L=FontAwesome.GetIcon({style:{position:"absolute",left:-17},key:"plus"}))),"Delete"===t.getKey()&&vt.length>0&&SkyDesktop.Confirm({msg:"정말 삭제 하시겠습니까?"},()=>{EACH(vt,t=>{ht({ftpInfo:t.getFTPInfo(),path:t.getPath()})})}),"Enter"===t.getKey()&&0===UUI.CONFIRM.getCount()&&vt.length>0&&EACH(vt,t=>{t.checkIsInstanceOf(SkyEditor.Folder)===!0?t.open():t.checkIsInstanceOf(SkyEditor.File)===!0&&t.fireEvent("doubletap")}),"F2"===t.getKey()&&1===vt.length){let t=vt[0],e=t.getPath();SkyDesktop.Prompt({msg:"새 이름을 입력해주시기 바랍니다.",value:e.substring(e.lastIndexOf("/")+1)},n=>{Dt(),kt({fromFTPInfo:t.getFTPInfo(),toFTPInfo:t.getFTPInfo(),from:e,to:e.substring(0,e.lastIndexOf("/"))+"/"+n})})}if(vt.length>0)if("ArrowUp"===t.getKey()){let e,n=vt[vt.length-1];if(EACH(n.getParent().getChildren(),t=>{if(t.checkIsInstanceOf(SkyEditor.File)===!0||t.checkIsInstanceOf(SkyEditor.Folder)===!0){if(t===n)return!1;e=t}}),void 0===e){if(n.getParent()!==Y){let t;EACH(n.getParent().getParent().getChildren(),e=>{return e!==n.getParent()&&void(t=e)}),void 0!==t&&(Rt(n),Ct(t))}}else Rt(n),e.checkIsInstanceOf(SkyEditor.Folder)===!0&&COUNT_PROPERTIES(e.getItems())>0?EACH(e.getItems(),t=>{return REVERSE_EACH(t.getParent().getChildren(),t=>{if(t.checkIsInstanceOf(SkyEditor.File)===!0||t.checkIsInstanceOf(SkyEditor.Folder)===!0)return Ct(t),!1}),!1}):Ct(e);t.stopDefault()}else if("ArrowDown"===t.getKey()){let e=vt[vt.length-1];if(e.checkIsInstanceOf(SkyEditor.Folder)===!0&&COUNT_PROPERTIES(e.getItems())>0)EACH(e.getItems(),t=>{return EACH(t.getParent().getChildren(),t=>{if(t.checkIsInstanceOf(SkyEditor.File)===!0||t.checkIsInstanceOf(SkyEditor.Folder)===!0)return Ct(t),!1}),!1});else{let t;if(REVERSE_EACH(e.getParent().getChildren(),n=>{if(n.checkIsInstanceOf(SkyEditor.File)===!0||n.checkIsInstanceOf(SkyEditor.Folder)===!0){if(n===e)return!1;t=n}}),void 0===t){if(e.getParent()!==Y){let t;REVERSE_EACH(e.getParent().getParent().getChildren(),n=>{return n!==e.getParent()&&void(t=n)}),void 0!==t&&(Rt(e),Ct(t))}}else Rt(e),Ct(t)}t.stopDefault()}else if("ArrowLeft"===t.getKey()){if("TEXTAREA"!==document.activeElement.tagName&&"INPUT"!==document.activeElement.tagName){let t=vt[vt.length-1];if(t.checkIsInstanceOf(SkyEditor.Folder)===!0&&COUNT_PROPERTIES(t.getItems())>0)t.fireEvent("doubletap");else{let e;EACH(t.getParent().getParent().getChildren(),n=>{return n!==t.getParent()&&void(e=n)}),void 0!==e&&(Rt(t),Ct(e))}}t.stopDefault()}else if("ArrowRight"===t.getKey()){if("TEXTAREA"!==document.activeElement.tagName&&"INPUT"!==document.activeElement.tagName){let t=vt[vt.length-1];t.checkIsInstanceOf(SkyEditor.Folder)===!0&&COUNT_PROPERTIES(t.getItems())>0?EACH(t.getItems(),t=>{return EACH(t.getParent().getChildren(),t=>{if(t.checkIsInstanceOf(SkyEditor.File)===!0||t.checkIsInstanceOf(SkyEditor.Folder)===!0)return Ct(t),!1}),!1}):t.checkIsInstanceOf(SkyEditor.Folder)===!0&&t.fireEvent("doubletap")}t.stopDefault()}}),EVENT("keyup",t=>{"Control"!==t.getKey()&&"Meta"!==t.getKey()||(at=!1,void 0!==L&&(L.remove(),L=void 0))});e.setDraggingShadow=(t=>{N=t,at===!0&&N.append(L=FontAwesome.GetIcon({style:{position:"absolute",left:-17},key:"plus"}))}),e.getDraggingShadow=(()=>{return N});EVENT("touchmove",t=>{void 0!==N&&N.addStyle({left:t.getLeft()+10,top:t.getTop()+10})}),EVENT("touchend",()=>{DELAY(()=>{void 0!==N&&(N.remove(),N=void 0,L=void 0)})});let Ot,bt=(e.setWorkspacePath=(t=>{x=t}),e.getWorkspacePath=(()=>{return x}),e.addTab=(t=>{X.addTab(t)})),_t=e.search=(()=>{let t=!1;SkyDesktop.Prompt({msg:["검색할 문자열을 입력해주세요.",DIV({style:{marginTop:10},c:UUI.FULL_CHECKBOX({label:"대소문자 구분",on:{change:(e,n)=>{t=n.getValue()}}})})],value:Ot},e=>{if(""!==e){let n,o,i,r,s=[];bt(n=SkyDesktop.Tab({style:{position:"relative"},size:30,c:[o=UUI.ICON_BUTTON({style:{position:"absolute",right:10,top:8,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc",zIndex:999},icon:FontAwesome.GetIcon("times"),on:{mouseover:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#999"})},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"})},tap:()=>{n.remove(),EVENT.fireAll("resize")}}}),i=A({style:{position:"absolute",right:30,top:6,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#ccc",zIndex:999},c:"전체 변경",on:{mouseover:(t,e)=>{e.addStyle({color:(void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme,"#999")})},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#ccc"})},tap:()=>{SkyDesktop.Prompt({msg:"변경할 문자열을 입력해주세요."},o=>{let i=SkyDesktop.LoadingBar("lime");NEXT(s,[(n,i)=>{lt({path:n.path,content:n.content.replace(new RegExp(e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t===!0?"g":"ig"),o),isFindAndReplace:!0},()=>{i()})},()=>{return()=>{SkyDesktop.Noti("모두 저장하였습니다."),i.done()}}]),n.remove(),EVENT.fireAll("resize")})}}}),r=SkyDesktop.FileTree(ot)],on:{scroll:()=>{o.addStyle({top:8+n.getScrollTop()}),i.addStyle({top:6+n.getScrollTop()})}}}));let a=(n,o,i)=>{let d=0,c="__MORE_BUTTON_"+UUID();RUN(u=>{let l=0;for(;d<o.length;){let t=o[d];if("node_modules"!==t&&dt(n+"/"+t,(e,o)=>{a(n+"/"+t,e,o)}),d+=1,l+=1,20===l)break}if(l<20)for(;d-o.length<i.length;){let a=i[d-o.length],c=n+"/"+a;if(ct({path:c},n=>{s.push({path:c,content:n});let o=[];if(EACH(n.split("\n"),(n,i)=>{i+=1,(t===!0?n.indexOf(e)!==-1:n.toLowerCase().indexOf(e.toLowerCase())!==-1)&&o.push({lineNumber:i,line:n})}),o.length>0){let n;r.addItem({key:c,item:n=SkyEditor.FoundFile({path:c,title:c.substring(c.lastIndexOf("/")+1)})}),EACH(o,o=>{n.addItem({key:c+":"+o.lineNumber,item:SkyEditor.FoundLine({path:c,findText:e,lineNumber:o.lineNumber,line:o.line.trim(),isToCheckCase:t,on:{doubletap:()=>{ot(c,17*(o.lineNumber-1-10),e)}}})})})}}),d+=1,l+=1,20===l)break}20===l&&r.addItem({key:c,item:SkyEditor.More({title:"더 보기...",on:{tap:()=>{u()}}})}),d===o.length+i.length&&r.removeItem(c)})};EACH(vt,t=>{void 0===t.getFTPInfo()&&(t.checkIsInstanceOf(SkyEditor.Folder)===!0?dt(t.getPath(),(e,n)=>{a(t.getPath(),e,n)}):t.checkIsInstanceOf(SkyEditor.File)===!0&&a(t.getFolderPath(),[],[t.getTitle()]))}),Ot=e}})});e.setDropTargetInfo=(t=>{M=t}),e.init=(t=>{n=t.showHome,o=t.load,i=t.loadFiles,r=t.save,s=t.createFolder,a=t.remove,d=t.move,c=t.clone,u=t.getInfo,l=t.checkExists,f=t.ftpNew,p=t.ftpDestroy,g=t.ftpList,h=t.ftpConnect,k=t.ftpLoad,E=t.ftpLoadFiles,m=t.ftpSave,y=t.ftpCreateFolder,S=t.ftpRemove,I=t.ftpMove,v=t.ftpClone,T=t.ftpGetInfo,D=t.ftpCheckExists,_=t.copy,F=t.paste,w=t.overFileSize,C=t.gitClone,R=t.gitDiff,O=t.gitPush,b=t.gitPull,e.appendTo(BODY),e.on("drop",t=>{void 0!==M&&(EACH(t.getFiles(),t=>{let e=t.name,n=new FileReader;n.onload=(t=>{let n=t.target.result,o=/^data:.+\/(.+);base64,(.*)$/,i=n.match(o),r=(i[1],i[2]),s=new Buffer(r,"base64"),a=SkyDesktop.LoadingBar("lime");NEXT([t=>{ut({ftpInfo:M.ftpInfo,path:M.folderPath+"/"+e},n=>{n===!0?SkyDesktop.Confirm({msg:e+"이(가) 존재합니다. 덮어쓰시겠습니까?"},{ok:()=>{t()},cancel:()=>{a.done()}}):t()})},()=>{return()=>{lt({ftpInfo:M.ftpInfo,path:M.folderPath+"/"+e,buffer:s},()=>{a.done()}),M=void 0}}])}),n.readAsDataURL(t)}),t.stop())}),0===st.length?n():NEXT(st,(t,e)=>{let n=t.path;o(n,()=>{H.remove(n),e()},o=>{let i=n.substring(n.lastIndexOf("/")+1),r=nt(j(i.substring(i.lastIndexOf(".")+1).toLowerCase())({title:i,path:n,content:o}));r.setScrollTop(t.scrollTop),e()})})});EVENT("dragover",t=>{t.stop()})}}),SkyEditor.Layout=CLASS(t=>{let e;t.getContent=(()=>{return e});return{preset:()=>{return VIEW},init:(t,n)=>{let o=DIV({}).appendTo(BODY);t.on("close",()=>{o.remove(),e=void 0})}}}),SkyEditor.MAIN=METHOD({run:()=>{SkyEditor.IDE.addEditor({extname:"txt",editor:SkyEditor.TextEditor}),SkyEditor.IDE.addEditor({extname:"js",editor:SkyEditor.JavaScriptEditor}),SkyEditor.IDE.addEditor({extname:"json",editor:SkyEditor.JSONEditor}),SkyEditor.IDE.addEditor({extname:"babelrc",editor:SkyEditor.JSONEditor}),SkyEditor.IDE.addEditor({extname:"html",editor:SkyEditor.HTMLEditor}),SkyEditor.IDE.addEditor({extname:"css",editor:SkyEditor.CSSEditor}),SkyEditor.IDE.addEditor({extname:"hx",editor:SkyEditor.HaxeEditor}),SkyEditor.IDE.addEditor({extname:"as",editor:SkyEditor.ActionScriptEditor}),SkyEditor.IDE.addEditor({extname:"erl",editor:SkyEditor.ErlangEditor}),SkyEditor.IDE.addEditor({extname:"md",editor:SkyEditor.MarkdownEditor}),SkyEditor.IDE.addEditor({extname:"gml",editor:SkyEditor.GMLEditor}),SkyEditor.IDE.addEditor({extname:"php",editor:SkyEditor.PHPEditor}),SkyEditor.IDE.addEditor({extname:"xml",editor:SkyEditor.XMLEditor}),SkyEditor.IDE.addEditor({extname:"java",editor:SkyEditor.JavaEditor}),SkyEditor.IDE.addEditor({extname:"nsp",editor:SkyEditor.NSPEditor}),SkyEditor.IDE.addEditor({extname:"less",editor:SkyEditor.LessEditor}),SkyEditor.IDE.addEditor({extname:"csv",editor:SkyEditor.CSVEditor})}}),SkyEditor.AceEditor=CLASS({preset:()=>{return SkyEditor.Editor},init:(t,e,n)=>{let o=n.mode,i=n.content;void 0!==i&&i.length>1048576&&(i=void 0,DELAY(()=>{SkyEditor.IDE.getEditorOpenedStore().remove(e.getPath()),e.remove()}),SkyEditor.IDE.overFileSize({ftpInfo:e.getFTPInfo(),path:e.getPath()}));let r;e.append(r=DIV({style:{height:"100%"},c:i}));let s=ace.edit(r.getEl());s.setTheme("ace/theme/twilight"),s.setFontSize(14),void 0!==o&&s.getSession().setMode("ace/mode/"+o),s.getSession().setUseSoftTabs(!1),s.getSession().on("changeScrollTop",()=>{e.fireEvent("scroll")}),s.getSession().on("change",()=>{e.fireEvent("change")}),s.renderer.setScrollMargin(0,300),s.setShowPrintMargin(!1),s.commands.addCommand({name:"replace2",bindKey:{win:"Ctrl-R",mac:"Command-Option-F"},exec:t=>{ace.config.loadModule("ace/ext/searchbox",e=>{e.Search(t,!0);let n=t.searchBox.$searchBarKb,o=n.commands["Ctrl-f|Commasnd-f|Ctrl-H|Command-Option-F"];void 0!==o&&o.bindKey.indexOf("Ctrl-R")===-1&&(o.bindKey+="|Ctrl-R",n.addCommand(o))})}}),s.$blockScrolling=1/0,e.on("active",()=>{s.focus(),s.resize()});let a=EVENT("resize",()=>{DELAY(.1,()=>{s.resize()})});e.on("remove",()=>{a.remove(),a=void 0});let d;OVERRIDE(e.getScrollTop,t=>{d=e.getScrollTop=(()=>{return s.getSession().getScrollTop()})});let c;OVERRIDE(e.setScrollTop,t=>{c=e.setScrollTop=(t=>{s.getSession().setScrollTop(t)})});let u;OVERRIDE(e.setFindText,t=>{u=e.setFindText=(t=>{ace.config.loadModule("ace/ext/searchbox",e=>{new e.SearchBox(s).show(t)})})});let l;OVERRIDE(e.getContent,t=>{l=e.getContent=(()=>{return s.getValue()})});let f;OVERRIDE(e.setContent,t=>{f=e.setContent=(t=>{i=t,s.setValue(i,1)})}),void 0!==i&&(f(i),s.getSession().setUndoManager(new ace.UndoManager));t.getEditor=(()=>{return r}),t.getAceEditor=(()=>{return s})}}),SkyEditor.CSVEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.CSVEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/csv.png")})}));return{preset:()=>{return SkyEditor.Editor},params:()=>{return{mode:"csv",icon:e()}},init:(t,e,n)=>{let o,i=n.content;e.append(DIV({style:{width:"100%",height:"100%",overflow:"hidden"},c:o=IFRAME({style:{backgroundColor:"#fff",width:"100%",height:"100%"},src:SkyEditor.R("handsontable/editor.html"),on:{load:(t,n)=>{try{"about:blank"===n.getEl().contentWindow.location.href?e.remove():(n.getEl().contentWindow.save=(()=>{SkyEditor.IDE.saveTab(e)}),void 0===i&&(i=s()),r(i))}catch(t){}}}})})),e.on("active",()=>{try{o.getEl().focus(),o.getEl().contentWindow.fixScroll()}catch(t){}});let r;OVERRIDE(e.setContent,t=>{r=e.setContent=(t=>{try{o.getEl().contentWindow.loadData(__PAPA.parse(t).data)}catch(t){}})});let s;OVERRIDE(e.getContent,t=>{s=e.getContent=(()=>{try{return __PAPA.unparse({data:o.getEl().contentWindow.getData()})}catch(t){return""}})})}}}),SkyEditor.GitEditor=CLASS(t=>{let e=SkyEditor.STORE("gitInfoStore");return{preset:()=>{return SkyEditor.Editor},init:(t,n,o)=>{let i=o.folderPath;n.setTitle(i.substring(i.lastIndexOf("/")+1)),n.setIcon(IMG({src:SkyEditor.R("icon/git.png")})),SkyEditor.IDE.checkExists({path:i+"/.git"},t=>{t===!0?NEXT([t=>{if(void 0===e.get(i)){let n;SkyDesktop.Confirm({okButtonTitle:"저장",msg:n=UUI.VALID_FORM({errorMsgs:{url:{notEmpty:"저장소 URL을 입력해주세요."},username:{notEmpty:"아이디를 입력해주세요."},password:{notEmpty:"비밀번호를 입력해주세요."}},errorMsgStyle:{color:"red"},c:[INPUT({style:{width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"url",placeholder:"저장소 URL"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"username",placeholder:"아이디"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},type:"password",name:"password",placeholder:"비밀번호"})]})},()=>{let o=n.getData(),r=VALID({url:{notEmpty:!0},username:{notEmpty:!0},password:{notEmpty:!0}}),s=r.check(o);return s.checkHasError()===!0?(n.showErrors(s.getErrors()),!1):(e.save({name:i,value:o}),void t())})}else t()},()=>{return()=>{let t,o,r=e.get(i),s=()=>{t.empty();let e=SkyDesktop.LoadingBar("lime");SkyEditor.IDE.gitDiff({url:r.url,path:i,username:r.username,password:r.password},{error:t=>{e.done(),SkyDesktop.Alert({msg:t})},success:(n,o,i,r)=>{e.done(),EACH(o,e=>{t.append(UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/edit.png")}),spacing:5,title:e}))}),EACH(n,e=>{t.append(UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/add.png")}),spacing:5,title:e}))}),EACH(i,e=>{t.append(UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/move.png")}),spacing:5,title:e}))}),EACH(r,e=>{t.append(UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/delete.png")}),spacing:5,title:e}))})}})};n.append(DIV({style:{padding:10},c:[DIV({style:{padding:5,backgroundColor:"#222"},c:UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/setting.png")}),spacing:5,title:"Git 정보 변경",on:{tap:()=>{let t;SkyDesktop.Confirm({okButtonTitle:"저장",msg:t=UUI.VALID_FORM({errorMsgs:{url:{notEmpty:"저장소 URL을 입력해주세요."},username:{notEmpty:"아이디를 입력해주세요."},password:{notEmpty:"비밀번호를 입력해주세요."}},errorMsgStyle:{color:"red"},c:[INPUT({style:{width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"url",value:r.url,placeholder:"저장소 URL"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"username",value:r.username,placeholder:"아이디"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},type:"password",name:"password",value:r.password,placeholder:"비밀번호"})]})},()=>{let n=t.getData(),o=VALID({url:{notEmpty:!0},username:{notEmpty:!0},password:{notEmpty:!0}}),s=o.check(n);return s.checkHasError()===!0?(t.showErrors(s.getErrors()),!1):(e.save({name:i,value:n}),void(r=n))})}}})}),DIV({style:{marginTop:10,padding:5,backgroundColor:"#222"},c:UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/pull.png")}),spacing:5,title:"풀",on:{tap:()=>{let t=SkyDesktop.LoadingBar("lime");SkyEditor.IDE.gitPull({url:r.url,path:i,username:r.username,password:r.password},{error:e=>{t.done(),SkyDesktop.Alert({msg:e})},success:()=>{t.done(),SkyDesktop.Noti("풀 받았습니다."),s()}})}}})}),DIV({style:{marginTop:10,padding:5,backgroundColor:"#222"},c:[UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/push.png")}),spacing:5,title:"푸시",on:{tap:()=>{let t=SkyDesktop.LoadingBar("lime");SkyEditor.IDE.gitPush({url:r.url,path:i,username:r.username,password:r.password,message:o.getValue()},{error:e=>{t.done(),SkyDesktop.Alert({msg:e})},success:()=>{t.done(),SkyDesktop.Noti("푸시했습니다."),o.setValue("no message"),s()}})}}}),H3({style:{marginTop:5},c:"푸시 메시지"}),o=UUI.FULL_INPUT({style:{marginTop:5},value:"no message"})]}),DIV({style:{marginTop:10,padding:5,backgroundColor:"#222"},c:[UUI.BUTTON_H({style:{padding:5},icon:IMG({src:SkyEditor.R("icon/refresh.png")}),isIconRight:!0,spacing:10,title:"변경 내역",on:{tap:()=>{s()}}}),t=DIV()]})]})),s()}}]):(SkyDesktop.Alert({msg:"Git 저장소가 아닙니다."}),n.remove())})}}}),SkyEditor.ActionScriptEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.ActionScriptEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/actionscript.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"actionscript",icon:e()}}}}),SkyEditor.CompareEditor=CLASS({preset:()=>{return SkyEditor.Editor},params:()=>{return{icon:IMG({src:SkyEditor.R("icon/compare.png")})}},init:(t,e,n)=>{let o,i,r,s=n.path1,a=n.content1,d=(n.path2,n.content2),c=Date.now(),u="__COMPARE_LEFT_"+c,l="__COMPARE_GUTTER_"+c,f="__COMPARE_RIGHT_"+c;e.append(o=DIV({style:{flt:"left",width:"45%",height:"100%"}})),o.getEl().setAttribute("id",u),e.append(i=DIV({style:{flt:"left",width:"10%",height:"100%",overflow:"hidden"}})),i.getEl().setAttribute("id",l),e.append(r=DIV({style:{flt:"left",width:"45%",height:"100%"}})),r.getEl().setAttribute("id",f),e.append(CLEAR_BOTH());let p;e.on("show",()=>{p=new AceDiff({left:{id:u,content:a},right:{id:f,content:d},classes:{gutterID:l}});let t=t=>{t.setTheme("ace/theme/twilight"),t.setFontSize(14),p.lineHeight=t.renderer.lineHeight,t.getSession().setUseSoftTabs(!1),t.getSession().on("changeScrollTop",()=>{e.fireEvent("scroll")}),t.getSession().on("change",()=>{e.fireEvent("change")}),t.renderer.setScrollMargin(0,300),t.commands.addCommand({name:"replace2",bindKey:{win:"Ctrl-R",mac:"Command-Option-F"},exec:t=>{ace.config.loadModule("ace/ext/searchbox",e=>{e.Search(t,!0);let n=t.searchBox.$searchBarKb,o=n.commands["Ctrl-f|Commasnd-f|Ctrl-H|Command-Option-F"];void 0!==o&&o.bindKey.indexOf("Ctrl-R")===-1&&(o.bindKey+="|Ctrl-R",n.addCommand(o))})}}),t.$blockScrolling=1/0};t(p.getEditors().left),t(p.getEditors().right)}),e.on("remove",()=>{void 0!==p&&p.destroy()});e.getPath1=(()=>{return s}),e.getContent1=(()=>{return a}),e.getPath2=(()=>{return s}),e.getContent2=(()=>{return d})}}),SkyEditor.CSSEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.CSSEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/css.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"css",icon:e()}}}}),SkyEditor.ErlangEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.ErlangEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/erlang.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"erlang",icon:e()}}}}),SkyEditor.GMLEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.GMLEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/gml.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"gml",icon:e()}}}}),SkyEditor.HaxeEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.HaxeEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/haxe.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"haxe",icon:e()}}}}),SkyEditor.HTMLEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.HTMLEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/html.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"html",icon:e()}}}}),SkyEditor.JavaEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.JavaEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/java.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"java",icon:e()}}}}),SkyEditor.JavaScriptEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.JavaScriptEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/javascript.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"javascript",icon:e()}}}}),SkyEditor.JSONEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.JSONEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/json.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"json",icon:e()}}}}),SkyEditor.LessEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.LessEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/less.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"less",icon:e()}}}}),SkyEditor.MarkdownEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.MarkdownEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/markdown.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"markdown",icon:e(),style:{position:"relative",backgroundColor:"#fff"}}},init:(t,e)=>{let n=t.getEditor(),o=t.getAceEditor(),i=new Worker(SkyEditor.R("js/markdown-generate-worker.js"));o.getSession().setUseWrapMode(!0),n.addStyle({flt:"left",width:"50%"});let r,s;e.append(r=DIV({style:{position:"absolute",right:0,top:0,color:"#000",height:"100%",overflowX:"auto",overflowY:"scroll",onDisplayResize:()=>{return{width:n.getWidth()}}},c:s=DIV({style:{padding:10,fontSize:14}})})),e.on("active",()=>{r.addStyle({width:n.getWidth()})}),i.addEventListener("message",t=>{s.getEl().innerHTML=t.data},!1),s.getEl().setAttribute("class","markdown-body");let a,d;o.getSession().on("change",RAR(()=>{let t=o.getValue();void 0!==a&&clearTimeout(a),a=setTimeout(()=>{d!==t&&(i.postMessage(t),d=t),a=void 0},500)}))}}}),SkyEditor.NSPEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.NSPEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/nsp.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"nsp",icon:e()}}}}),SkyEditor.PHPEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.PHPEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/php.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"php",icon:e()}}}}),SkyEditor.TextEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.TextEditor"}),t.getIcon=(()=>{return IMG({src:SkyDesktop.R("file.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{mode:"text",icon:e()}},init:(t,e)=>{t.getAceEditor().getSession().setUseWrapMode(!0)}}}),SkyEditor.XMLEditor=CLASS(t=>{let e=(t.getName=(()=>{return"SkyEditor.XMLEditor"}),t.getIcon=(()=>{return IMG({src:SkyEditor.R("icon/xml.png")})}));return{preset:()=>{return SkyEditor.AceEditor},params:()=>{return{
mode:"xml",icon:e()}}}}),SkyEditor.File=CLASS({preset:()=>{return SkyDesktop.File},init:(t,e,n)=>{let o=n.ftpInfo,i=n.title,r=e.getPath(),s=r.substring(0,r.lastIndexOf("/")),a=(e.getFTPInfo=(()=>{return o}),e.getFolderPath=(()=>{return s}),SkyEditor.IDE.getEditor(i.substring(i.lastIndexOf(".")+1).toLowerCase()));void 0!==a&&e.setIcon(a.getIcon());let d,c,u,l,f;e.on("touchstart",t=>{u=!0,l=t.getLeft(),f=t.getTop()});let p=EVENT("touchmove",t=>{if(void 0===SkyEditor.IDE.getDraggingShadow()&&u===!0&&(Math.abs(l-t.getLeft())>5||Math.abs(f-t.getTop())>5)){CHECK_IS_IN({array:SkyEditor.IDE.getSelectedFileItems(),value:e})!==!0&&SkyEditor.IDE.selectFile(e);let n=SkyEditor.IDE.getSelectedFileItems().length;SkyEditor.IDE.setDraggingShadow(DIV({style:{position:"fixed",left:t.getLeft()+10,top:t.getTop()+10},c:n>1?n+"개 파일":e.getTitle()}).appendTo(BODY))}}),g=EVENT("touchend",()=>{u===!0&&(u=!1)});e.on("touchend",()=>{void 0!==SkyEditor.IDE.getDraggingShadow()&&EACH(SkyEditor.IDE.getSelectedFileItems(),t=>{let e=t.getPath();(SkyEditor.IDE.checkIsControlMode()===!0?SkyEditor.IDE.clone:SkyEditor.IDE.move)({fromFTPInfo:t.getFTPInfo(),toFTPInfo:o,from:e,to:s+"/"+e.substring(e.lastIndexOf("/")+1)})})}),e.on("tap",t=>{d===!0?SkyEditor.IDE.selectMultipleFile(e):c===!0?SkyEditor.IDE.selectFileRange(e):SkyEditor.IDE.selectFile(e)}),e.on("contextmenu",t=>{CHECK_IS_IN({array:SkyEditor.IDE.getSelectedFileItems(),value:e})!==!0&&SkyEditor.IDE.selectFile(e),SkyEditor.FileContextMenu({ftpInfo:o,path:r,folderPath:s,e:t}),t.stop()}),e.on("drop",t=>{SkyEditor.IDE.setDropTargetInfo({ftpInfo:o,folderPath:s})});let h=EVENT("keydown",t=>{"Control"===t.getKey()&&(d=!0),"Shift"===t.getKey()&&(c=!0)}),k=EVENT("keyup",t=>{"Control"===t.getKey()&&(d=!1),"Shift"===t.getKey()&&(c=!1)});e.on("remove",()=>{p.remove(),p=void 0,g.remove(),g=void 0,h.remove(),h=void 0,k.remove(),k=void 0})}}),SkyEditor.FileContextMenu=CLASS({preset:()=>{return SkyDesktop.ContextMenu},init:(t,e,n)=>{let o=n.ftpInfo,i=n.path,r=n.folderPath,s=SkyEditor.IDE.getSelectedFileItems();if(s.length>0&&e.append(SkyDesktop.ContextMenuItem({title:"열기",icon:IMG({src:SkyEditor.R("icon/open.png")}),on:{tap:()=>{EACH(s,t=>{t.checkIsInstanceOf(SkyEditor.Folder)===!0?t.open():t.checkIsInstanceOf(SkyEditor.File)===!0&&t.fireEvent("doubletap")}),e.remove()}}})),e.append(SkyDesktop.ContextMenuItem({title:"새 파일",icon:IMG({src:SkyDesktop.R("file.png")}),on:{tap:()=>{SkyDesktop.Prompt("파일명을 입력해주시기 바랍니다.",t=>{""!==t.trim()&&RUN(e=>{SkyEditor.IDE.checkExists({ftpInfo:o,path:r+"/"+t},n=>{if(n===!0){let n="",o=t.lastIndexOf(".");o!==-1&&(n=t.substring(o),t=t.substring(0,o)),t=t+" (2)"+n,e()}else SkyEditor.IDE.saveTab(SkyEditor.IDE.openEditor(SkyEditor.IDE.getEditor(t.substring(t.lastIndexOf(".")+1).toLowerCase())({ftpInfo:o,title:t,path:r+"/"+t})))})})}),e.remove()}}})),e.append(SkyDesktop.ContextMenuItem({title:"새 폴더",icon:IMG({src:SkyDesktop.R("folder.png")}),on:{tap:()=>{SkyDesktop.Prompt("폴더명을 입력해주시기 바랍니다.",t=>{""!==t.trim()&&SkyEditor.IDE.createFolder({ftpInfo:o,path:r+"/"+t})}),e.remove()}}})),s.length>0&&e.append(SkyDesktop.ContextMenuItem({title:"복사",icon:IMG({src:SkyEditor.R("icon/copy.png")}),on:{tap:()=>{let t=[];EACH(s,e=>{t.push({ftpInfo:e.getFTPInfo(),path:e.getPath()})}),SkyEditor.IDE.copy(t),e.remove()}}})),e.append(SkyDesktop.ContextMenuItem({title:"붙여넣기",icon:IMG({src:SkyEditor.R("icon/paste.png")}),on:{tap:()=>{SkyEditor.IDE.paste({ftpInfo:o,folderPath:r}),e.remove()}}})),s.length>0&&e.append(SkyDesktop.ContextMenuItem({title:"삭제",icon:IMG({src:SkyEditor.R("icon/delete.png")}),on:{tap:()=>{SkyDesktop.Confirm({msg:"정말 삭제 하시겠습니까?"},()=>{EACH(s,t=>{SkyEditor.IDE.remove({ftpInfo:t.getFTPInfo(),path:t.getPath()})})}),e.remove()}}})),void 0!==i&&1===s.length&&(e.append(SkyDesktop.ContextMenuItem({title:"이름 변경",icon:IMG({src:SkyEditor.R("icon/rename.png")}),on:{tap:()=>{SkyDesktop.Prompt({msg:"새 이름을 입력해주시기 바랍니다.",value:i.substring(i.lastIndexOf("/")+1)},t=>{SkyEditor.IDE.deselectFiles(),SkyEditor.IDE.move({fromFTPInfo:o,toFTPInfo:o,from:i,to:i.substring(0,i.lastIndexOf("/"))+"/"+t})}),e.remove()}}})),e.append(SkyDesktop.ContextMenuItem({title:"파일 정보",icon:IMG({src:SkyEditor.R("icon/info.png")}),on:{tap:()=>{SkyEditor.IDE.getInfo({ftpInfo:o,path:i},t=>{let e,n=CALENDAR(t.createTime),o=CALENDAR(t.lastUpdateTime);SkyDesktop.Alert({style:{onDisplayResize:(t,e)=>{return t>400?{width:380}:{width:"90%"}}},msg:e=TABLE({style:{textAlign:"left"},c:[TR({c:[TH({style:{width:90},c:"경로"}),TD({style:{wordBreak:"break-all"},c:i})]}),TR({c:[TH({style:{width:60},c:"파일 생성일"}),TD({style:{wordBreak:"break-all"},c:n.getYear()+"년 "+n.getMonth()+"월 "+n.getDate()+"일 "+n.getHour()+"시 "+n.getMinute()+"분"})]}),TR({c:[TH({style:{width:60},c:"최종 수정일"}),TD({style:{wordBreak:"break-all"},c:o.getYear()+"년 "+o.getMonth()+"월 "+o.getDate()+"일 "+o.getHour()+"시 "+o.getMinute()+"분"})]})]})}),void 0!==t.size&&e.append(TR({c:[TH({style:{width:60},c:"파일 크기"}),TD({style:{wordBreak:"break-all"},c:Math.ceil(t.size/1e3)+"KB"})]}))}),e.remove()}}})),s[0].checkIsInstanceOf(SkyEditor.File)===!0&&e.append(SkyDesktop.ContextMenuItem({title:"로컬 저장 기록 보기",icon:IMG({src:SkyEditor.R("icon/history.png")}),on:{tap:()=>{let t,n,r;SkyEditor.IDE.addTab(t=SkyDesktop.Tab({style:{position:"relative"},size:30,c:[n=UUI.ICON_BUTTON({style:{position:"absolute",right:10,top:8,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc",zIndex:999},icon:FontAwesome.GetIcon("times"),on:{mouseover:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#999"})},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"})},tap:()=>{t.remove(),EVENT.fireAll("resize")}}}),r=DIV()],on:{scroll:()=>{n.addStyle({top:8+t.getScrollTop()})}}})),SkyEditor.IDE.load({path:i},t=>{let e=SkyEditor.IDE.getLocalHistory({ftpInfo:o,path:i});REVERSE_EACH(e,e=>{if(e.content!==t){let n=CALENDAR(e.time),o=n.getYear()+"-"+n.getMonth(!0)+"-"+n.getDate(!0)+" "+n.getHour(!0)+":"+n.getMinute(!0);r.append(SkyEditor.HistoryItem({title:o,on:{doubletap:()=>{SkyEditor.IDE.openEditor(SkyEditor.CompareEditor({title:"로컬 저장 기록 비교 (현재 - "+o+")",path1:i,content1:t,content2:e.content}))}}}))}})}),e.remove()}}}))),void 0===o&&s.length>0&&e.append(SkyDesktop.ContextMenuItem({title:"검색",icon:IMG({src:SkyEditor.R("icon/search.png")}),on:{tap:()=>{SkyEditor.IDE.search(),e.remove()}}})),s.length>=2){let t,n;EACH(s,e=>{if(e.checkIsInstanceOf(SkyEditor.File)===!0){if(void 0!==t)return n=e,!1;t=e}}),void 0!==n&&e.append(SkyDesktop.ContextMenuItem({title:"두 파일 비교",icon:IMG({src:SkyEditor.R("icon/compare.png")}),on:{tap:()=>{let o=t.getPath(),i=n.getPath();SkyEditor.IDE.load({ftpInfo:t.getFTPInfo(),path:o},t=>{SkyEditor.IDE.load({ftpInfo:n.getFTPInfo(),path:i},e=>{let n=o.substring(o.lastIndexOf("/")+1),r=i.substring(i.lastIndexOf("/")+1);SkyEditor.IDE.openEditor(SkyEditor.CompareEditor({title:"두 파일 비교 ("+n+" - "+r+")",path1:o,content1:t,path2:i,content2:e}))})}),e.remove()}}}))}r.substring(0,r.lastIndexOf("/"))===SkyEditor.IDE.getWorkspacePath()&&e.append(SkyDesktop.ContextMenuItem({title:"Git 설정",icon:IMG({src:SkyEditor.R("icon/git.png")}),on:{tap:()=>{SkyEditor.IDE.openEditor(SkyEditor.GitEditor({folderPath:r})),e.remove()}}}))}}),SkyEditor.Folder=CLASS({preset:()=>{return SkyDesktop.Folder},init:(t,e,n)=>{let o,i,r,s,a,d=n.ftpInfo,c=e.getPath(),u=e.getPath();e.getFTPInfo=(()=>{return d}),e.getFolderPath=(()=>{return u});e.on("touchstart",t=>{r=!0,s=t.getLeft(),a=t.getTop()});let l=EVENT("touchmove",t=>{if(void 0===SkyEditor.IDE.getDraggingShadow()&&r===!0&&(Math.abs(s-t.getLeft())>5||Math.abs(a-t.getTop())>5)){CHECK_IS_IN({array:SkyEditor.IDE.getSelectedFileItems(),value:e})!==!0&&SkyEditor.IDE.selectFile(e);let n=SkyEditor.IDE.getSelectedFileItems().length;SkyEditor.IDE.setDraggingShadow(DIV({style:{position:"fixed",left:t.getLeft()+10,top:t.getTop()+10},c:n>1?n+"개 파일":e.getTitle()}).appendTo(BODY))}}),f=EVENT("touchend",()=>{r===!0&&(r=!1)});e.on("touchend",()=>{void 0!==SkyEditor.IDE.getDraggingShadow()&&EACH(SkyEditor.IDE.getSelectedFileItems(),t=>{let e=t.getPath();(SkyEditor.IDE.checkIsControlMode()===!0?SkyEditor.IDE.clone:SkyEditor.IDE.move)({fromFTPInfo:t.getFTPInfo(),toFTPInfo:d,from:e,to:u+"/"+e.substring(e.lastIndexOf("/")+1)})})}),e.on("tap",()=>{o===!0?SkyEditor.IDE.selectMultipleFile(e):i===!0?SkyEditor.IDE.selectFileRange(e):SkyEditor.IDE.selectFile(e)}),e.on("contextmenu",t=>{CHECK_IS_IN({array:SkyEditor.IDE.getSelectedFileItems(),value:e})!==!0&&SkyEditor.IDE.selectFile(e),SkyEditor.FileContextMenu({ftpInfo:d,path:c,folderPath:u,e:t}),t.stop()}),e.on("drop",t=>{SkyEditor.IDE.setDropTargetInfo({ftpInfo:d,folderPath:u})});let p=EVENT("keydown",t=>{"Control"===t.getKey()&&(o=!0),"Shift"===t.getKey()&&(i=!0)}),g=EVENT("keyup",t=>{"Control"===t.getKey()&&(o=!1),"Shift"===t.getKey()&&(i=!1)});e.on("remove",()=>{l.remove(),l=void 0,f.remove(),f=void 0,p.remove(),p=void 0,g.remove(),g=void 0});let h;OVERRIDE(e.getItem,t=>{h=e.getItem=(n=>{let o=t(n);return void 0===o&&EACH(e.getItems(),t=>{if(t.checkIsInstanceOf(SkyDesktop.Folder)===!0){let e=t.getItem(n);if(void 0!==e)return o=e,!1}}),o})})}}),SkyEditor.FoundFile=CLASS({preset:()=>{return SkyDesktop.File},params:()=>{return{style:{position:"relative"}}},init:(t,e,n)=>{let o=n.title,i=SkyEditor.IDE.getEditor(o.substring(o.lastIndexOf(".")+1).toLowerCase());void 0!==i&&e.setIcon(i.getIcon());let r;e.append(r=UUI.ICON_BUTTON({style:{position:"absolute",left:-12,top:3,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"},icon:FontAwesome.GetIcon("chevron-right"),on:{mouseover:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#999"}),t.stop()},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"}),t.stop()},tap:t=>{s.checkIsShowing()===!0?d():a(),t.stop()}}}));let s=UUI.LIST({style:{marginLeft:20}});e.after(s);let a=e.open=(()=>{s.show(),r.setIcon(FontAwesome.GetIcon("chevron-down")),r.addStyle({left:-14,top:1}),e.fireEvent("open")}),d=e.close=(()=>{s.hide(),r.setIcon(FontAwesome.GetIcon("chevron-right")),r.addStyle({left:-12,top:2}),e.fireEvent("close")});e.on("remove",()=>{DELAY(()=>{s.remove()})});let c=e.addItem=(t=>{s.addItem(t)});void 0!==n&&void 0!==n.items&&EACH(n.items,(t,e)=>{c({key:e,item:t})});let u;e.getItems=(()=>{return s.getItems()}),e.getItem=(t=>{return s.getItem(t)}),e.removeItem=(t=>{s.removeItem(t)}),e.removeAllItems=(()=>{s.removeAllItems()});e.on("mouseover",(t,e)=>{u!==!0&&e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#003333":"#AFCEFF"})}),e.on("mouseout",(t,e)=>{u!==!0&&e.addStyle({backgroundColor:"transparent"})});e.select=(()=>{e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#17344D":"#A2C5FF"}),u=!0}),e.checkInSelected=(()=>{return u}),e.deselect=(()=>{e.addStyle({backgroundColor:"transparent"}),u=!1})}}),SkyEditor.FoundLine=CLASS({preset:()=>{return UUI.BUTTON_H},params:()=>{return{style:{marginLeft:20,padding:"2px 5px",cursor:"default"},icon:IMG({src:SkyEditor.R("icon/found-line.png")}),spacing:5,isToFixWrapperSize:!0}},init:(t,e,n)=>{let o=(n.path,n.findText),i=n.lineNumber,r=n.line,s=n.isToCheckCase,a=[i,": "],d=s===!0?r:r.toLowerCase(),c=s===!0?o:o.toLowerCase();for(;d.indexOf(c)!==-1;){let t=d.indexOf(c),e=r.substring(t,t+c.length);a.push(r.substring(0,t)),a.push(SPAN({style:{backgroundColor:"red"},c:e})),r=r.substring(t+c.length),d=d.substring(t+c.length)}a.push(r),e.setTitle(SPAN({c:a}));let u;e.on("mouseover",(t,e)=>{u!==!0&&e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#003333":"#AFCEFF"})}),e.on("mouseout",(t,e)=>{u!==!0&&e.addStyle({backgroundColor:"transparent"})});e.select=(()=>{e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#17344D":"#A2C5FF"}),u=!0}),e.checkInSelected=(()=>{return u}),e.deselect=(()=>{e.addStyle({backgroundColor:"transparent"}),u=!1})}}),SkyEditor.FTPItem=CLASS({preset:()=>{return UUI.BUTTON_H},params:()=>{return{style:{position:"relative",marginLeft:20,padding:"2px 5px",cursor:"default"},icon:IMG({src:SkyEditor.R("icon/ftp.png")}),spacing:5,isToFixWrapperSize:!0}},init:(t,e,n)=>{let o;e.append(o=UUI.ICON_BUTTON({style:{position:"absolute",left:-12,top:3,color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"},icon:FontAwesome.GetIcon("chevron-right"),on:{mouseover:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#666":"#999"}),t.stop()},mouseout:(t,e)=>{e.addStyle({color:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#444":"#ccc"}),t.stop()},tap:t=>{i.checkIsShowing()===!0?s():r(),t.stop()}}}));let i=UUI.LIST({style:{marginLeft:20}});e.after(i);let r=e.open=(()=>{i.show(),o.setIcon(FontAwesome.GetIcon("chevron-down")),o.addStyle({left:-14,top:1}),e.fireEvent("open")}),s=e.close=(()=>{i.hide(),o.setIcon(FontAwesome.GetIcon("chevron-right")),o.addStyle({left:-12,top:2}),e.fireEvent("close")});i.hide(),e.on("doubletap",()=>{i.checkIsShowing()===!0?s():r()}),e.on("remove",()=>{DELAY(()=>{i.remove()})});let a,d=()=>{i.sortItems((t,e)=>{return t.checkIsInstanceOf(SkyDesktop.File)===!0&&e.checkIsInstanceOf(SkyDesktop.File)===!0||t.checkIsInstanceOf(SkyDesktop.Folder)===!0&&e.checkIsInstanceOf(SkyDesktop.Folder)===!0?t.getTitle().toLowerCase().localeCompare(e.getTitle().toLowerCase()):t.checkIsInstanceOf(SkyDesktop.File)===!0&&e.checkIsInstanceOf(SkyDesktop.Folder)===!0?1:t.checkIsInstanceOf(SkyDesktop.Folder)===!0&&e.checkIsInstanceOf(SkyDesktop.File)===!0?-1:t.checkIsInstanceOf(SkyDesktop.File)!==!0&&t.checkIsInstanceOf(SkyDesktop.Folder)!==!0?1:e.checkIsInstanceOf(SkyDesktop.File)!==!0&&e.checkIsInstanceOf(SkyDesktop.Folder)!==!0?-1:0})};e.addItem=(t=>{i.addItem(t),d()}),e.getItems=(()=>{return i.getItems()}),e.getItem=(t=>{return i.getItem(t)}),e.removeItem=(t=>{i.removeItem(t),d()}),e.removeAllItems=(()=>{i.removeAllItems()});e.on("mouseover",(t,e)=>{a!==!0&&e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#003333":"#AFCEFF"})}),e.on("mouseout",(t,e)=>{a!==!0&&e.addStyle({backgroundColor:"transparent"})}),e.on("contextmenu",t=>{let o=SkyDesktop.ContextMenu({e:t,c:[SkyDesktop.ContextMenuItem({title:"정보 수정",on:{tap:()=>{let t,i,r=n.privateKey;SkyDesktop.Confirm({okButtonTitle:"저장",msg:t=UUI.VALID_FORM({errorMsgs:{title:{notEmpty:"사이트 이름을 입력해주세요."},host:{notEmpty:"호스트를 입력해주세요."},username:{notEmpty:"아이디를 입력해주세요."}},errorMsgStyle:{color:"red"},c:[INPUT({style:{width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"title",value:n.title,placeholder:"사이트 이름"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"host",value:n.host,placeholder:"호스트"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"port",value:n.port,placeholder:"포트 번호"}),SELECT({style:{marginTop:10,width:240,padding:8,border:"1px solid #999",borderRadius:4},name:"protocol",value:n.protocol,c:[OPTION({value:"ftp",c:"FTP"}),OPTION({value:"sftp",c:"SFTP"})],on:{change:(t,e)=>{void 0!==i&&("sftp"===e.getValue()?i.show():i.hide())}}}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"username",value:n.username,placeholder:"로그인 아이디"}),INPUT({style:{marginTop:10,width:222,padding:8,border:"1px solid #999",borderRadius:4},type:"password",name:"password",value:n.password,placeholder:"비밀번호"}),i=DIV({style:{display:"none",marginTop:10},c:[H3({c:"Private Key"}),INPUT({style:{marginTop:5,width:222,padding:8,border:"1px solid #999",borderRadius:4},name:"privateKey",type:"file",on:{change:(t,e)=>{let n=new FileReader;n.readAsText(e.getFiles()[0]),n.onload=(t=>{r=t.target.result})}}})]})]})},()=>{let o=t.getData();if(VALID.notEmpty(o.password)!==!0&&void 0===r)return SkyDesktop.Alert({msg:"비밀번호를 입력해주세요."}),!1;{o.privateKey=r;let i=VALID({title:{notEmpty:!0},host:{notEmpty:!0},username:{notEmpty:!0}}),a=i.check(o);if(a.checkHasError()===!0)return t.showErrors(a.getErrors()),!1;{let t=SkyDesktop.LoadingBar("lime");SkyEditor.IDE.ftpDestroy(n,()=>{SkyEditor.IDE.ftpNew(o,()=>{e.setTitle(o.title),s(),n=o,t.done()})})}}}),o.remove()}}}),SkyDesktop.ContextMenuItem({title:"삭제",on:{tap:()=>{SkyDesktop.Confirm({msg:"정말 삭제 하시겠습니까?"},()=>{let t=SkyDesktop.LoadingBar("lime");SkyEditor.IDE.ftpDestroy(n,()=>{t.done(),e.remove()})}),o.remove()}}})]});t.stop()});e.select=(()=>{e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#17344D":"#A2C5FF"}),a=!0}),e.checkInSelected=(()=>{return a}),e.deselect=(()=>{e.addStyle({backgroundColor:"transparent"}),a=!1})}}),SkyEditor.HistoryItem=CLASS({preset:()=>{return UUI.BUTTON_H},params:()=>{return{style:{padding:"2px 5px",cursor:"default"},icon:IMG({src:SkyEditor.R("icon/calendar.png")}),spacing:5,isToFixWrapperSize:!0}},init:(t,e,n)=>{let o;e.on("mouseover",(t,e)=>{o!==!0&&e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#003333":"#AFCEFF"})}),e.on("mouseout",(t,e)=>{o!==!0&&e.addStyle({backgroundColor:"transparent"})});e.select=(()=>{e.addStyle({backgroundColor:void 0!==BROWSER_CONFIG.SkyDesktop&&"dark"===BROWSER_CONFIG.SkyDesktop.theme?"#17344D":"#A2C5FF"}),o=!0}),e.checkInSelected=(()=>{return o}),e.deselect=(()=>{e.addStyle({backgroundColor:"transparent"}),o=!1})}}),SkyEditor.More=CLASS({preset:()=>{return UUI.BUTTON_H},params:()=>{return{style:{marginLeft:20,padding:"2px 5px",whiteSpace:"nowrap"},isToFixWrapperSize:!0}}});